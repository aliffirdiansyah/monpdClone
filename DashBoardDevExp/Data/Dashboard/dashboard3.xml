<?xml version="1.0" encoding="utf-8"?>
<Dashboard>
  <Title Text="PBJT Target dan Realisasi" />
  <DataSources>
    <SqlDataSource Name="Oracle Data Source" ComponentName="sqlDataSource1">
      <Connection Name="connection" ProviderKey="Oracle">
        <Parameters>
          <Parameter Name="server" Value="10.21.39.80:1521/devdb" />
          <Parameter Name="database" Value="" />
          <Parameter Name="read only" Value="1" />
          <Parameter Name="generateConnectionHelper" Value="false" />
          <Parameter Name="OracleProviderType" Value="ODPManaged" />
          <Parameter Name="userid" Value="monpd" />
          <Parameter Name="password" Value="monpd2025" />
        </Parameters>
      </Connection>
      <Query Type="CustomSqlQuery" Name="PBJTTdanR">
        <Sql>SELECT A.*,B.JUMLAH_OP
FROM (                        
SELECT A.TAHUN_BUKU,A.PAJAK_ID,NAMA,TARGET,REALISASI,(realisasi / NULLIF(target, 0)) AS PENCAPAIAN
FROM (
                SELECT TAHUN_BUKU,B.ID PAJAK_ID,B.NAMA , SUM(TARGET) TARGET
                FROM DB_AKUN_TARGET A
                JOIN M_PAJAK B ON A.PAJAK_ID=B.ID
                WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5 AND B.ID IN (1,2,3,4,5,6,7)
                GROUP BY TAHUN_BUKU,B.ID ,B.NAMA
) A
LEFT JOIN (
SELECT TAHUN_BUKU,3 PAJAK_ID,SUM(NOMINAL_POKOK_BAYAR) REALISASI 
FROM DB_MON_HOTEL
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU,1 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_RESTO
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU,5 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_HIBURAN
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU,4 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_PARKIR
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU,2 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_PPJ
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU, 7 PAJAK_ID,
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_REKLAME
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU, 6 PAJAK_ID,
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_ABT
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
)  B ON A.TAHUN_BUKU=B.TAHUN_BUKU AND A.PAJAK_ID=B.PAJAK_ID
) A
JOIN (            
            SELECT TAHUN_BUKU,3 ID, COUNT(1) JUMLAH_OP
            FROM DB_OP_HOTEL
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,1 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_RESTO
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5 AND PAJAK_NAMA != 'MAMIN'
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,5 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_HIBURAN
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,4 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_PARKIR
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,2 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_LISTRIK
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,7 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_REKLAME
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,6 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_ABT
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
        ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU AND A.PAJAK_ID=B.ID </Sql>
      </Query>
      <Query Type="CustomSqlQuery" Name="TahunBukuList">
        <Sql>SELECT TO_CHAR(SYSDATE,'YYYY') +1  - LEVEL AS tahun
FROM dual
CONNECT BY LEVEL &lt;= 6</Sql>
      </Query>
      <ConnectionOptions CloseConnection="true" />
    </SqlDataSource>
  </DataSources>
  <Parameters>
    <Parameter Name="TahunBuku" Type="System.Int16">
      <DynamicListLookUpSettings DataSourceName="sqlDataSource1" DataMember="TahunBukuList" ValueMember="TAHUN" DisplayMember="TAHUN" SortByMember="TAHUN" SortOrder="Descending" />
    </Parameter>
  </Parameters>
  <Items>
    <Grid ComponentName="gridDashboardItem1" Name="Target dan Realisasi" DataSource="sqlDataSource1" DataMember="PBJTTdanR" FilterString="[DataItem6] = ?TahunBuku">
      <DataItems>
        <Dimension DataMember="NAMA" DefaultId="DataItem1" />
        <Dimension DataMember="PAJAK_ID" DefaultId="DataItem5" />
        <Dimension DataMember="TAHUN_BUKU" DefaultId="DataItem6" />
        <Dimension DataMember="PAJAK_ID" DefaultId="DataItem0" />
        <Dimension DataMember="TAHUN_BUKU" DefaultId="DataItem7">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" />
        </Dimension>
        <Dimension DataMember="TARGET" DefaultId="DataItem2">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Dimension>
        <Dimension DataMember="REALISASI" DefaultId="DataItem3">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Dimension>
        <Dimension DataMember="PENCAPAIAN" DefaultId="DataItem4">
          <NumericFormat FormatType="Percent" />
        </Dimension>
        <Dimension DataMember="JUMLAH_OP" DefaultId="DataItem8">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Dimension>
      </DataItems>
      <HiddenDimensions>
        <Dimension DefaultId="DataItem5" />
        <Dimension DefaultId="DataItem6" />
      </HiddenDimensions>
      <GridColumns>
        <GridDimensionColumn Name="Id">
          <Dimension DefaultId="DataItem0" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Tahun">
          <Dimension DefaultId="DataItem7" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Nama">
          <Dimension DefaultId="DataItem1" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Jumlah OP">
          <Dimension DefaultId="DataItem8" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Target">
          <Dimension DefaultId="DataItem2" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Realisasi">
          <Dimension DefaultId="DataItem3" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Pencapaian">
          <Dimension DefaultId="DataItem4" />
        </GridDimensionColumn>
      </GridColumns>
      <GridOptions />
      <ColumnFilterOptions />
    </Grid>
    <Grid ComponentName="gridDashboardItem2" Name="Grid 1" DataSource="sqlDataSource1" DataMember="PBJTTdanR">
      <GridOptions />
      <ColumnFilterOptions />
    </Grid>
    <Grid ComponentName="gridDashboardItem3" Name="Grid 2" DataSource="sqlDataSource1" DataMember="PBJTTdanR">
      <GridOptions />
      <ColumnFilterOptions />
    </Grid>
  </Items>
  <LayoutTree>
    <LayoutGroup Orientation="Vertical">
      <LayoutGroup Weight="0.7035673606854934">
        <LayoutItem DashboardItem="gridDashboardItem1" />
        <LayoutItem DashboardItem="gridDashboardItem3" />
      </LayoutGroup>
      <LayoutItem DashboardItem="gridDashboardItem2" Weight="1.2964326393145065" />
    </LayoutGroup>
  </LayoutTree>
</Dashboard>