<?xml version="1.0" encoding="utf-8"?>
<Dashboard>
  <Title Text="PBJT Target dan Realisasi" />
  <DataSources>
    <SqlDataSource Name="Oracle Data Source" ComponentName="sqlDataSource1">
      <Connection Name="connection" ProviderKey="Oracle">
        <Parameters>
          <Parameter Name="server" Value="10.21.39.80:1521/devdb" />
          <Parameter Name="database" Value="" />
          <Parameter Name="read only" Value="1" />
          <Parameter Name="generateConnectionHelper" Value="false" />
          <Parameter Name="OracleProviderType" Value="ODPManaged" />
          <Parameter Name="userid" Value="monpd" />
          <Parameter Name="password" Value="monpd2025" />
        </Parameters>
      </Connection>
      <Query Type="CustomSqlQuery" Name="PBJTTdanR">
        <Sql>SELECT A.*,B.JUMLAH_OP
FROM (                        
SELECT A.TAHUN_BUKU,A.PAJAK_ID,NAMA,TARGET,REALISASI,(realisasi / NULLIF(target, 0)) AS PENCAPAIAN
FROM (
                SELECT TAHUN_BUKU,B.ID PAJAK_ID,B.NAMA , SUM(TARGET) TARGET
                FROM DB_AKUN_TARGET A
                JOIN M_PAJAK B ON A.PAJAK_ID=B.ID
                WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5 AND B.ID IN (1,2,3,4,5,6)
                GROUP BY TAHUN_BUKU,B.ID ,B.NAMA
) A
LEFT JOIN (
SELECT TAHUN_BUKU,3 PAJAK_ID,SUM(NOMINAL_POKOK_BAYAR) REALISASI 
FROM DB_MON_HOTEL
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU,1 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_RESTO
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU,5 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_HIBURAN
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU,4 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_PARKIR
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU,2 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_PPJ
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
UNION ALL
SELECT TAHUN_BUKU, 6 PAJAK_ID,
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_ABT
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU
)  B ON A.TAHUN_BUKU=B.TAHUN_BUKU AND A.PAJAK_ID=B.PAJAK_ID
) A
JOIN (            
            SELECT TAHUN_BUKU,3 ID, COUNT(1) JUMLAH_OP
            FROM DB_OP_HOTEL
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,1 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_RESTO
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5 AND PAJAK_NAMA != 'MAMIN'
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,5 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_HIBURAN
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,4 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_PARKIR
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
            UNION ALL
            SELECT TAHUN_BUKU,2 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_LISTRIK
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU            
            UNION ALL
            SELECT TAHUN_BUKU,6 ID,COUNT(1) JUMLAH_OP
            FROM DB_OP_ABT
            WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
            GROUP BY TAHUN_BUKU
        ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU AND A.PAJAK_ID=B.ID</Sql>
      </Query>
      <Query Type="CustomSqlQuery" Name="TahunBukuList">
        <Sql>SELECT TO_CHAR(SYSDATE,'YYYY') +1  - LEVEL AS tahun
FROM dual
CONNECT BY LEVEL &lt;= 6</Sql>
      </Query>
      <Query Type="CustomSqlQuery" Name="DetailBulan">
        <Sql>SELECT A.TAHUN_BUKU,A.BULAN,A.PAJAK_ID,JML_OP,TARGET,REALISASI,PENCAPAIAN
FROM (
SELECT A.TAHUN_BUKU,A.BULAN, A.PAJAK_ID,NAMA,TARGET,REALISASI,(realisasi / NULLIF(target, 0)) AS PENCAPAIAN
FROM (
                SELECT TAHUN_BUKU,BULAN,B.ID PAJAK_ID,B.NAMA , SUM(TARGET) TARGET
                FROM DB_AKUN_TARGET_BULAN A
                JOIN M_PAJAK B ON A.PAJAK_ID=B.ID
                WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5 AND B.ID IN (1,2,3,4,5,6)
                GROUP BY TAHUN_BUKU,BULAN,B.ID ,B.NAMA
) A
LEFT JOIN (
SELECT TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK) BULAN,3 PAJAK_ID,SUM(NOMINAL_POKOK_BAYAR) REALISASI 
FROM DB_MON_HOTEL
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK)
UNION ALL
SELECT TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK),1 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_RESTO
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK)
UNION ALL
SELECT TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK),5 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_HIBURAN
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK)
UNION ALL
SELECT TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK),4 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_PARKIR
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK)
UNION ALL
SELECT TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK),2 PAJAK_ID, 
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_PPJ
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK)
UNION ALL
SELECT TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK), 6 PAJAK_ID,
            SUM(NOMINAL_POKOK_BAYAR) REALISASI
FROM DB_MON_ABT
WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
GROUP BY TAHUN_BUKU,EXTRACT(MONTH FROM TGL_BAYAR_POKOK)
)  B ON A.TAHUN_BUKU=B.TAHUN_BUKU AND A.PAJAK_ID=B.PAJAK_ID AND A.BULAN=B.BULAN            
) A
JOIN (
            SELECT TAHUN_BUKU,BULAN,PAJAK_ID,SUM(STATUS) JML_OP
FROM (
SELECT A.*,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT 3 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_HOTEL
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
)                                
GROUP BY TAHUN_BUKU,BULAN,PAJAK_ID
UNION ALL
SELECT TAHUN_BUKU,BULAN,PAJAK_ID,SUM(STATUS) JML_OP
FROM (
SELECT A.*,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT 1 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_RESTO
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6            AND PAJAK_NAMA!='MAMIN'                   
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
)                                
GROUP BY TAHUN_BUKU,BULAN,PAJAK_ID
UNION ALL
SELECT TAHUN_BUKU,BULAN,PAJAK_ID,SUM(STATUS) JML_OP
FROM (
SELECT A.*,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT 2 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_LISTRIK
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
)                                
GROUP BY TAHUN_BUKU,BULAN,PAJAK_ID
UNION ALL
SELECT TAHUN_BUKU,BULAN,PAJAK_ID,SUM(STATUS) JML_OP
FROM (
SELECT A.*,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT 4 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_PARKIR
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
)                                
GROUP BY TAHUN_BUKU,BULAN,PAJAK_ID
UNION ALL
SELECT TAHUN_BUKU,BULAN,PAJAK_ID,SUM(STATUS) JML_OP
FROM (
SELECT A.*,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT 5 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_HIBURAN
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
)                                
GROUP BY TAHUN_BUKU,BULAN,PAJAK_ID
UNION ALL
SELECT TAHUN_BUKU,BULAN,PAJAK_ID,SUM(STATUS) JML_OP
FROM (
SELECT A.*,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT 6 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_ABT
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
)                                
GROUP BY TAHUN_BUKU,BULAN,PAJAK_ID
) B ON A.TAHUN_BUKU=B.TAHUN_BUKU AND A.BULAN=B.BULAN AND A.PAJAK_ID=B.PAJAK_ID
ORDER BY A.TAHUN_BUKU DESC,A.PAJAK_ID, A.BULAN</Sql>
      </Query>
      <Query Type="CustomSqlQuery" Name="DetailPBJT">
        <Sql>SELECT A.*,
            B.TAHUN_PAJAK_KETETAPAN,B.MASA_PAJAK_KETETAPAN, BULAN_BAYAR, TAHUN_BAYAR,NOMINAL_POKOK_BAYAR, TGL_REALISASI
FROM (
SELECT A.TAHUN_BUKU,A.BULAN, A.PAJAK_ID,NAMA,TARGET,B.NOP,B.NAMA_OP,B.ALAMAT_OP,B.KATEGORI_NAMA,TGL_MULAI_BUKA_OP,TGL_OP_TUTUP
FROM (
                SELECT TAHUN_BUKU,BULAN,B.ID PAJAK_ID,B.NAMA , SUM(TARGET) TARGET
                FROM DB_AKUN_TARGET_BULAN A
                JOIN M_PAJAK B ON A.PAJAK_ID=B.ID
                WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5 AND B.ID IN (1,2,3,4,5,6)
                GROUP BY TAHUN_BUKU,BULAN,B.ID ,B.NAMA
) A
LEFT JOIN (
                -- resto
                SELECT A.*, NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,
                                1 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_resto
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
                -- end resto
                UNION ALL
                -- listrik
                SELECT A.*, NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,
                                2 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_LISTRIK
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
                -- end listrik
                UNION ALL
                -- HOTEL
                SELECT A.*, NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,
                                3 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_HOTEL
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
                -- end HOTEL
                UNION ALL
                -- PARKIR
                SELECT A.*, NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,
                                4 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_PARKIR
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
                -- end PARKIR
                UNION ALL
                -- HIBURAN
                SELECT A.*, NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,
                                5 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_HIBURAN
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
                -- end HIBURAN
                UNION ALL
                -- PAT
                SELECT A.*, NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,PAJAK_ID,TGL_MULAI_BUKA_OP, TGL_OP_TUTUP,BLN_TUTUP,THN_TUTUP,            
            CASE
             WHEN TGL_OP_TUTUP IS NULL THEN 1
             WHEN ADD_MONTHS(TRUNC(TO_DATE(A.TAHUN_BUKU, 'YYYY'), 'YYYY'), A.BULAN - 1)  &gt; ADD_MONTHS(TRUNC(TO_DATE(THN_TUTUP, 'YYYY'), 'YYYY'), BLN_TUTUP - 1) THEN 0
             ELSE
             1 END STATUS             
FROM (
SELECT TAHUN_BUKU, EXTRACT (MONTH FROM AWAL_BULAN) BULAN 
FROM (
SELECT tb.tahun TAHUN_BUKU,ADD_MONTHS(TRUNC(TO_DATE(tb.tahun, 'YYYY'), 'YYYY'), lvl - 1) AS awal_bulan
FROM (
                SELECT TO_CHAR(SYSDATE,'YYYY') + 1 - LEVEL AS tahun
                FROM dual
                CONNECT BY LEVEL &lt;= 6
        ) tb
CROSS JOIN (SELECT LEVEL lvl FROM dual CONNECT BY LEVEL &lt;= 12)
)
)  A
LEFT JOIN (                    
                    SELECT NOP,NAMA_OP,ALAMAT_OP,KATEGORI_NAMA,
                                6 PAJAK_ID,TAHUN_BUKU, TGL_MULAI_BUKA_OP , TGL_OP_TUTUP, EXTRACT (MONTH FROM TGL_OP_TUTUP) BLN_TUTUP,EXTRACT (YEAR FROM TGL_OP_TUTUP) THN_TUTUP
                    FROM DB_OP_ABT
                    WHERE TAHUN_BUKU &gt;= TO_CHAR(SYSDATE,'YYYY')-6                               
                ) B ON A.TAHUN_BUKU=B.TAHUN_BUKU
                -- end PAT                
) B ON A.TAHUN_BUKU=B.TAHUN_BUKU AND A.BULAN=B.BULAN AND B.STATUS=1 AND A.PAJAK_ID=B.PAJAK_ID
) A
LEFT JOIN (            
                    SELECT TAHUN_BUKU,1 PAJAK_ID,NOP,TAHUN_PAJAK_KETETAPAN,MASA_PAJAK_KETETAPAN, EXTRACT(MONTH FROM TGL_BAYAR_POKOK) BULAN_BAYAR, EXTRACT(YEAR FROM TGL_BAYAR_POKOK) TAHUN_BAYAR,NOMINAL_POKOK_BAYAR,TGL_BAYAR_POKOK TGL_REALISASI 
                    FROM DB_MON_RESTO
                    WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
                    UNION ALL
                    SELECT TAHUN_BUKU,2 PAJAK_ID,NOP,TAHUN_PAJAK_KETETAPAN,MASA_PAJAK_KETETAPAN, EXTRACT(MONTH FROM TGL_BAYAR_POKOK) BULAN_BAYAR, EXTRACT(YEAR FROM TGL_BAYAR_POKOK) TAHUN_BAYAR,NOMINAL_POKOK_BAYAR,TGL_BAYAR_POKOK TGL_REALISASI 
                    FROM DB_MON_PPJ
                    WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
                    UNION ALL
                    SELECT TAHUN_BUKU,3 PAJAK_ID,NOP,TAHUN_PAJAK_KETETAPAN,MASA_PAJAK_KETETAPAN, EXTRACT(MONTH FROM TGL_BAYAR_POKOK) BULAN_BAYAR, EXTRACT(YEAR FROM TGL_BAYAR_POKOK) TAHUN_BAYAR,NOMINAL_POKOK_BAYAR,TGL_BAYAR_POKOK TGL_REALISASI 
                    FROM DB_MON_HOTEL
                    WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
                    UNION ALL
                    SELECT TAHUN_BUKU,4 PAJAK_ID,NOP,TAHUN_PAJAK_KETETAPAN,MASA_PAJAK_KETETAPAN, EXTRACT(MONTH FROM TGL_BAYAR_POKOK) BULAN_BAYAR, EXTRACT(YEAR FROM TGL_BAYAR_POKOK) TAHUN_BAYAR,NOMINAL_POKOK_BAYAR,TGL_BAYAR_POKOK TGL_REALISASI 
                    FROM DB_MON_PARKIR
                    WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
                    UNION ALL
                    SELECT TAHUN_BUKU,5 PAJAK_ID,NOP,TAHUN_PAJAK_KETETAPAN,MASA_PAJAK_KETETAPAN, EXTRACT(MONTH FROM TGL_BAYAR_POKOK) BULAN_BAYAR, EXTRACT(YEAR FROM TGL_BAYAR_POKOK) TAHUN_BAYAR,NOMINAL_POKOK_BAYAR,TGL_BAYAR_POKOK TGL_REALISASI 
                    FROM DB_MON_HIBURAN
                    WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
                    UNION ALL
                    SELECT TAHUN_BUKU,6 PAJAK_ID,NOP,TAHUN_PAJAK_KETETAPAN,MASA_PAJAK_KETETAPAN, EXTRACT(MONTH FROM TGL_BAYAR_POKOK) BULAN_BAYAR, EXTRACT(YEAR FROM TGL_BAYAR_POKOK) TAHUN_BAYAR,NOMINAL_POKOK_BAYAR,TGL_BAYAR_POKOK TGL_REALISASI 
                    FROM DB_MON_ABT
                    WHERE TAHUN_BUKU &gt;= EXTRACT(YEAR FROM SYSDATE) -5
) B ON A.TAHUN_BUKU = B.TAHUN_BUKU AND A.BULAN=B.BULAN_BAYAR AND A.PAJAK_ID=B.PAJAK_ID AND A.NOP=B.NOP 
</Sql>
      </Query>
      <ConnectionOptions CloseConnection="true" />
    </SqlDataSource>
  </DataSources>
  <Parameters>
    <Parameter Name="TahunBuku" Type="System.Int16" Value="2025">
      <DynamicListLookUpSettings DataSourceName="sqlDataSource1" DataMember="TahunBukuList" ValueMember="TAHUN" DisplayMember="TAHUN" SortByMember="TAHUN" SortOrder="Descending" />
    </Parameter>
  </Parameters>
  <Items>
    <Grid ComponentName="gridDashboardItem1" Name="Target dan Realisasi" DataSource="sqlDataSource1" DataMember="PBJTTdanR" FilterString="[DataItem6] = ?TahunBuku" IsMasterFilterCrossDataSource="true">
      <InteractivityOptions IgnoreMasterFilters="true" MasterFilterMode="Multiple" />
      <DataItems>
        <Dimension DataMember="NAMA" DefaultId="DataItem1" />
        <Dimension DataMember="PAJAK_ID" DefaultId="DataItem5" />
        <Dimension DataMember="TAHUN_BUKU" DefaultId="DataItem6" />
        <Dimension DataMember="PAJAK_ID" DefaultId="DataItem0" />
        <Dimension DataMember="TAHUN_BUKU" DefaultId="DataItem7">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" />
        </Dimension>
        <Dimension DataMember="TARGET" DefaultId="DataItem2">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Dimension>
        <Dimension DataMember="REALISASI" DefaultId="DataItem3">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Dimension>
        <Dimension DataMember="PENCAPAIAN" DefaultId="DataItem4">
          <NumericFormat FormatType="Percent" />
        </Dimension>
        <Dimension DataMember="JUMLAH_OP" DefaultId="DataItem8">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Dimension>
      </DataItems>
      <HiddenDimensions>
        <Dimension DefaultId="DataItem5" />
        <Dimension DefaultId="DataItem6" />
      </HiddenDimensions>
      <GridColumns>
        <GridDimensionColumn Name="Id">
          <Dimension DefaultId="DataItem0" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Tahun">
          <Dimension DefaultId="DataItem7" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Nama">
          <Dimension DefaultId="DataItem1" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Jumlah OP">
          <Dimension DefaultId="DataItem8" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Target">
          <Dimension DefaultId="DataItem2" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Realisasi">
          <Dimension DefaultId="DataItem3" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Pencapaian">
          <Dimension DefaultId="DataItem4" />
        </GridDimensionColumn>
      </GridColumns>
      <GridOptions />
      <ColumnFilterOptions />
    </Grid>
    <Grid ComponentName="gridDashboardItem2" Name="Grid 1" DataSource="sqlDataSource1" DataMember="PBJTTdanR">
      <GridOptions />
      <ColumnFilterOptions />
    </Grid>
    <Grid ComponentName="gridDashboardItem3" Name="Detail per Bulan" DataSource="sqlDataSource1" DataMember="DetailBulan" IsMasterFilterCrossDataSource="true">
      <InteractivityOptions MasterFilterMode="Multiple" />
      <DataItems>
        <Dimension DataMember="JML_OP" DefaultId="DataItem3">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Dimension>
        <Dimension DataMember="BULAN" DefaultId="DataItem2">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" />
        </Dimension>
        <Dimension DataMember="TARGET" DefaultId="DataItem4">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Dimension>
        <Measure DataMember="REALISASI" DefaultId="DataItem5">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" IncludeGroupSeparator="true" />
        </Measure>
        <Dimension DataMember="PENCAPAIAN" DefaultId="DataItem6">
          <NumericFormat FormatType="Percent" />
        </Dimension>
        <Dimension DataMember="PAJAK_ID" DefaultId="DataItem7">
          <NumericFormat FormatType="Number" Precision="0" Unit="Ones" />
        </Dimension>
        <Dimension DataMember="PAJAK_ID" DefaultId="DataItem0" />
        <Dimension DataMember="TAHUN_BUKU" DefaultId="DataItem1" />
        <Dimension DataMember="TAHUN_BUKU" DefaultId="DataItem8" />
      </DataItems>
      <HiddenDimensions>
        <Dimension DefaultId="DataItem0" />
        <Dimension DefaultId="DataItem1" />
      </HiddenDimensions>
      <GridColumns>
        <GridDimensionColumn Name="Bulan">
          <Dimension DefaultId="DataItem2" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Jumlah OP">
          <Dimension DefaultId="DataItem3" />
        </GridDimensionColumn>
        <GridDimensionColumn Name="Target">
          <Dimension DefaultId="DataItem4" />
        </GridDimensionColumn>
        <GridMeasureColumn Name="Realisasi">
          <Measure DefaultId="DataItem5" />
        </GridMeasureColumn>
        <GridDimensionColumn>
          <Dimension DefaultId="DataItem6" />
        </GridDimensionColumn>
        <GridDimensionColumn>
          <Dimension DefaultId="DataItem7" />
        </GridDimensionColumn>
        <GridDimensionColumn>
          <Dimension DefaultId="DataItem8" />
        </GridDimensionColumn>
      </GridColumns>
      <GridOptions />
      <ColumnFilterOptions />
    </Grid>
  </Items>
  <LayoutTree>
    <LayoutGroup Orientation="Vertical">
      <LayoutGroup Weight="0.7035673606854934">
        <LayoutItem DashboardItem="gridDashboardItem1" />
        <LayoutItem DashboardItem="gridDashboardItem3" />
      </LayoutGroup>
      <LayoutItem DashboardItem="gridDashboardItem2" Weight="1.2964326393145065" />
    </LayoutGroup>
  </LayoutTree>
</Dashboard>