@using static MonPDReborn.Models.DashboardVM
@model MonPDReborn.Models.DashboardVM.JumlahObjekPajak

@{
    var tahun1 = 2025;
    var tahun2 = 2024;
    var tahun3 = 2023;
    var tahun4 = 2022;
    var tahun5 = 2021;
}

@(
Html.DevExtreme().DataGrid<ViewModel.JumlahObjekPajak>()
    .ID("dg-JumlahObjekPajakTahunan")
    .ShowBorders(true)
    .ShowColumnLines(true)
    .ShowRowLines(true)
    .ColumnAutoWidth(true)
    .SearchPanel(s => s.Visible(true))
    .FilterRow(f => f.Visible(true))
    .HeaderFilter(h => h.Visible(true))
    .Sorting(s => s.Mode(GridSortingMode.Multiple))
    .AllowColumnResizing(true)
    .DataSource(Model.Data)
    .KeyExpr("JenisPajak")
    .Export(e => e.Enabled(true).Formats(new[] { "xlsx", "pdf" }))
    .OnExporting("exportGrid")
    .Columns(columns => {

        columns.AddFor(x => x.JenisPajak)
            .Caption("JENIS PAJAK")
            .Fixed(true)
            .FixedPosition(HorizontalEdge.Left)
            .CssClass("fw-bold");

        columns.Add()
            .Caption(tahun1.ToString())
            .Alignment(HorizontalAlignment.Center)
            .Columns(sub => {
                sub.AddFor(x => x.Tahun1_Awal).Caption("Awal").Format("#,##0");
                sub.AddFor(x => x.Tahun1_Tutup).Caption("Tutup").Format("#,##0");
                sub.AddFor(x => x.Tahun1_Baru).Caption("Baru").Format("#,##0");
                sub.AddFor(x => x.Tahun1_Akhir).Caption("Akhir").Format("#,##0");
            });

        columns.Add()
            .Caption(tahun2.ToString())
            .Alignment(HorizontalAlignment.Center)
            .Columns(sub => {
                sub.AddFor(x => x.Tahun2_Awal).Caption("Awal").Format("#,##0");
                sub.AddFor(x => x.Tahun2_Tutup).Caption("Tutup").Format("#,##0");
                sub.AddFor(x => x.Tahun2_Baru).Caption("Baru").Format("#,##0");
                sub.AddFor(x => x.Tahun2_Akhir).Caption("Akhir").Format("#,##0");
            });

        columns.Add()
            .Caption(tahun3.ToString())
            .Alignment(HorizontalAlignment.Center)
            .Columns(sub => {
                sub.AddFor(x => x.Tahun3_Awal).Caption("Awal").Format("#,##0");
                sub.AddFor(x => x.Tahun3_Tutup).Caption("Tutup").Format("#,##0");
                sub.AddFor(x => x.Tahun3_Baru).Caption("Baru").Format("#,##0");
                sub.AddFor(x => x.Tahun3_Akhir).Caption("Akhir").Format("#,##0");
            });

        columns.Add()
            .Caption(tahun4.ToString())
            .Alignment(HorizontalAlignment.Center)
            .Columns(sub => {
                sub.AddFor(x => x.Tahun4_Awal).Caption("Awal").Format("#,##0");
                sub.AddFor(x => x.Tahun4_Tutup).Caption("Tutup").Format("#,##0");
                sub.AddFor(x => x.Tahun4_Baru).Caption("Baru").Format("#,##0");
                sub.AddFor(x => x.Tahun4_Akhir).Caption("Akhir").Format("#,##0");
            });

        columns.Add()
            .Caption(tahun5.ToString())
            .Alignment(HorizontalAlignment.Center)
            .Columns(sub => {
                sub.AddFor(x => x.Tahun5_Awal).Caption("Awal").Format("#,##0");
                sub.AddFor(x => x.Tahun5_Tutup).Caption("Tutup").Format("#,##0");
                sub.AddFor(x => x.Tahun5_Baru).Caption("Baru").Format("#,##0");
                sub.AddFor(x => x.Tahun5_Akhir).Caption("Akhir").Format("#,##0");
            });
    })
    .Summary(s => {
        s.TotalItems(items => {
            items.AddFor(x => x.JenisPajak)
                .SummaryType(SummaryType.Count)
                .DisplayFormat("Total Jenis Pajak: {0}");
        });
    })
)
