@using static MonPDReborn.Models.DashboardVM
@model MonPDReborn.Models.DashboardVM.JumlahObjekPajakTahunan
@{
}

@(
    Html.DevExtreme().DataGrid<ViewModel.JumlahObjekPajakTahunan>()
        .ID("dg-JmlObjekPajakTahunan")
        .ShowBorders(true)
        .ShowColumnHeaders(true)
        .ShowColumnLines(true)
        .ShowRowLines(true)
        .ColumnAutoWidth(true)
        .SearchPanel(s => s.Visible(true).HighlightCaseSensitive(false))
        .FilterRow(f => f.Visible(true))
        .HeaderFilter(h => h.Visible(true))
        .Sorting(s => s.Mode(GridSortingMode.Multiple))
        .AllowColumnResizing(true)
        .DataSource(Model.Data)
        .KeyExpr("ID")
        .Export(e => e.Enabled(true).AllowExportSelectedData(false).Formats(new[] { "xlsx", "pdf" }))
        .OnExporting("exportGrid")
        .Columns(columns =>
        {
            columns.AddFor(x => x.JenisPajak).CssClass("fw-bold")
            .Caption("JENIS PAJAK").Fixed(true)
            .FixedPosition(HorizontalEdge.Left);
            columns.AddFor(x => x.JmlOpAwal).Format("#,##0")
            .DataType(GridColumnDataType.Number)
            .Caption("JML OP AWAL");
            @* columns.AddFor(x => x.JmlOpTutupSementara).Format("#,##0")
            .DataType(GridColumnDataType.Number)
            .Caption("JML OP TUTUP SEMENTARA"); *@
            columns.AddFor(x => x.JmlOpTutupPermanen).Format("#,##0")
            .DataType(GridColumnDataType.Number)
            .Caption("JML OP TUTUP");
            columns.AddFor(x => x.JmlOpBaru).Format("#,##0")
            .DataType(GridColumnDataType.Number)
            .Caption("JML OP BARU");
            columns.AddFor(x => x.JmlOpAkhir).Format("#,##0")
            .DataType(GridColumnDataType.Number)
            .Caption("JML OP AKHIR");
        })
        .Summary(s => {
            s.TotalItems(items => {
                items.AddFor(x => x.JmlOpAwal)
                    .ValueFormat("#,##0")
                    .DisplayFormat("{0}")
                    .SummaryType(SummaryType.Sum);
            });
            @* s.TotalItems(items => {
                items.AddFor(x => x.JmlOpTutupSementara)
                    .ValueFormat("#,##0")
                    .DisplayFormat("{0}")
                    .SummaryType(SummaryType.Sum);
            }); *@
            s.TotalItems(items => {
                items.AddFor(x => x.JmlOpTutupPermanen)
                    .ValueFormat("#,##0")
                    .DisplayFormat("{0}")
                    .SummaryType(SummaryType.Sum);
            });
            s.TotalItems(items => {
                items.AddFor(x => x.JmlOpBaru)
                    .ValueFormat("#,##0")
                    .DisplayFormat("{0}")
                    .SummaryType(SummaryType.Sum);
            });
            s.TotalItems(items => {
                items.AddFor(x => x.JmlOpAkhir)
                    .ValueFormat("#,##0")
                    .DisplayFormat("{0}")
                    .SummaryType(SummaryType.Sum);
            });
    })
)