@using static MonPDReborn.Models.DashboardVM
@model MonPDReborn.Models.DashboardVM.DataKontrolPotensiOp


@{
    var currentYear = DateTime.Now.Year;
    var tahun1 = (currentYear - 1).ToString();
    var tahun2 = currentYear.ToString();
}
@(
    Html.DevExtreme().DataGrid<ViewModel.DataKontrolPotensiOp>()
            .ID("dg-PotensiOp")
            .ShowBorders(true)
            .ShowColumnHeaders(true)
            .ShowColumnLines(true)
            .ShowRowLines(true)
            .ColumnAutoWidth(true)
            .SearchPanel(s => s.Visible(true).HighlightCaseSensitive(false))
            .FilterRow(f => f.Visible(true))
            .HeaderFilter(h => h.Visible(true))
            .Sorting(s => s.Mode(GridSortingMode.Multiple))
            .AllowColumnResizing(true)
            .DataSource(Model.Data)
            .KeyExpr("ID")
            .Export(e => e.Enabled(true).AllowExportSelectedData(false).Formats(new[] { "xlsx", "pdf" }))
            .OnExporting("exportGrid")
            .Columns(columns =>
            {
                columns.AddFor(x => x.JenisPajak).Caption("JENIS PAJAK").Alignment(HorizontalAlignment.Left).Fixed(true)
            .FixedPosition(HorizontalEdge.Left);
                columns.Add().Caption(tahun1).Alignment(HorizontalAlignment.Center)
                .Columns(subColumns =>
                {
                    subColumns.AddFor(x => x.Target1).Caption("TARGET").DataType(GridColumnDataType.Number).Format("#,##0");
                    subColumns.AddFor(x => x.Realisasi1).Caption("REALISASI").DataType(GridColumnDataType.Number).Format("#,##0");
                    subColumns.AddFor(x => x.Selisih1).Caption("SELISIH").DataType(GridColumnDataType.Number).Format("#,##0");
                    subColumns.AddFor(x => x.Persentase1).Caption("CAPAIAN (%)").DataType(GridColumnDataType.Number);
                });
                columns.Add().Caption(tahun2).Alignment(HorizontalAlignment.Center)
                .Columns(subColumns =>
                {
                    subColumns.AddFor(x => x.Target2).Caption("TARGET").DataType(GridColumnDataType.Number).Format("#,##0");
                    subColumns.AddFor(x => x.Realisasi2).Caption("REALISASI").DataType(GridColumnDataType.Number).Format("#,##0");
                    subColumns.AddFor(x => x.Selisih2).Caption("SELISIH").DataType(GridColumnDataType.Number).Format("#,##0");
                    subColumns.AddFor(x => x.Persentase2).Caption("CAPAIAN (%)").DataType(GridColumnDataType.Number);
                });
            })
.Summary(s => {
    s.TotalItems(items => {
        items.AddFor(x => x.Target1)
            .ValueFormat("#,##0")
            .DisplayFormat("Total: {0}")
            .SummaryType(SummaryType.Sum);
        items.AddFor(x => x.Realisasi1)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}")
            .SummaryType(SummaryType.Sum);
        items.AddFor(x => x.Selisih1)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}")
            .SummaryType(SummaryType.Sum);
        items.AddFor(x => x.Persentase1)
            .SummaryType(SummaryType.Avg)
            .DisplayFormat("{0}%");
        items.AddFor(x => x.Target2)
            .ValueFormat("#,##0")
            .DisplayFormat("Total: {0}")
            .SummaryType(SummaryType.Sum);
        items.AddFor(x => x.Realisasi2)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}")
            .SummaryType(SummaryType.Sum);
        items.AddFor(x => x.Selisih2)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}")
            .SummaryType(SummaryType.Sum);
        items.AddFor(x => x.Persentase2)
            .SummaryType(SummaryType.Avg)
            .DisplayFormat("{0}%");
    });
})
)

            
                