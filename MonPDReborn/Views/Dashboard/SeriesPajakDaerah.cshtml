@using static MonPDReborn.Models.DashboardVM
@model MonPDReborn.Models.DashboardVM.SeriesPajakDaerah

@{
    var currentYear = DateTime.Now.Year;
    var tahun1 = (currentYear-4).ToString();
    var tahun2 = (currentYear-3).ToString();
    var tahun3 = (currentYear-2).ToString();
    var tahun4 = (currentYear-1).ToString();
    var tahun5 = currentYear.ToString();
}

@(
    Html.DevExtreme().DataGrid<ViewModel.SeriesPajakDaerah>()
    .ID("dg-pajakDaerah")
    .ShowBorders(true)
    .ShowColumnHeaders(true)
    .ShowColumnLines(true)
    .ShowRowLines(true)
    .ColumnAutoWidth(true)
    .SearchPanel(s => s.Visible(true).HighlightCaseSensitive(false))
    .FilterRow(f => f.Visible(true))
    .HeaderFilter(h => h.Visible(true))
    .Sorting(s => s.Mode(GridSortingMode.Multiple))
    .AllowColumnResizing(true)
    .DataSource(Model.Data)
    .KeyExpr("ID")
    .Columns(columns =>
    {
        columns.AddFor(x => x.JenisPajak).CssClass("fw-bold")
            .Caption("JENIS PAJAK")
            .Fixed(true)
            .FixedPosition(HorizontalEdge.Left);

        columns.Add()
            .Caption(tahun1).Alignment(HorizontalAlignment.Center)
            .Columns(subColumns =>
            {
                subColumns.AddFor(x => x.Target1).Caption("TARGET").DataType(GridColumnDataType.Number).Format("#,##0");
                subColumns.AddFor(x => x.Realisasi1).Caption("REALISASI").DataType(GridColumnDataType.Number).Format("#,##0");;
                subColumns.AddFor(x => x.Persentase1).Caption("%");
            });

        columns.Add()
            .Caption(tahun2).Alignment(HorizontalAlignment.Center)
            .Columns(subColumns =>
            {
                subColumns.AddFor(x => x.Target2).Caption("TARGET").DataType(GridColumnDataType.Number).Format("#,##0");;
                subColumns.AddFor(x => x.Realisasi2).Caption("REALISASI").DataType(GridColumnDataType.Number).Format("#,##0");;
                subColumns.AddFor(x => x.Persentase2).Caption("%");
            });

        columns.Add()
            .Caption(tahun3).Alignment(HorizontalAlignment.Center)
            .Columns(subColumns =>
            {
                subColumns.AddFor(x => x.Target3).Caption("TARGET").DataType(GridColumnDataType.Number).Format("#,##0");;
                subColumns.AddFor(x => x.Realisasi3).Caption("REALISASI").DataType(GridColumnDataType.Number).Format("#,##0");;
                subColumns.AddFor(x => x.Persentase3).Caption("%");
            });

        columns.Add()
            .Caption(tahun4).Alignment(HorizontalAlignment.Center)
            .Columns(subColumns =>
            {
                subColumns.AddFor(x => x.Target4).Caption("TARGET").DataType(GridColumnDataType.Number).Format("#,##0");;
                subColumns.AddFor(x => x.Realisasi4).Caption("REALISASI").DataType(GridColumnDataType.Number).Format("#,##0");;
                subColumns.AddFor(x => x.Persentase4).Caption("%");
            });

        columns.Add()
            .Caption(tahun5).Alignment(HorizontalAlignment.Center)
            .Columns(subColumns =>
            {
                subColumns.AddFor(x => x.Target5).Caption("TARGET").DataType(GridColumnDataType.Number).Format("#,##0");;
                subColumns.AddFor(x => x.Realisasi5).Caption("REALISASI").DataType(GridColumnDataType.Number).Format("#,##0");;
                subColumns.AddFor(x => x.Persentase5).Caption("%");
            });
  
    })
    .Summary(s => {
        s.TotalItems(items => {
            items.AddFor(x => x.Target1)
                .ValueFormat("#,##0")
                .DisplayFormat("Total: {0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Realisasi1)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Persentase1)
                .SummaryType(SummaryType.Avg)
                .DisplayFormat("{0}%");

            items.AddFor(x => x.Target2)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Realisasi2)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Persentase2)
                .SummaryType(SummaryType.Avg)
                .DisplayFormat("{0}%");

            items.AddFor(x => x.Target3)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Realisasi3)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Persentase3)
                .SummaryType(SummaryType.Avg)
                .DisplayFormat("{0}%");

            items.AddFor(x => x.Target4)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Realisasi4)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Persentase4)
                .SummaryType(SummaryType.Avg)
                .DisplayFormat("{0}%");

            items.AddFor(x => x.Target5)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Realisasi5)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}")
                .SummaryType(SummaryType.Sum);

            items.AddFor(x => x.Persentase5)
                .SummaryType(SummaryType.Avg)
                .DisplayFormat("{0}%");
        });
    })
)