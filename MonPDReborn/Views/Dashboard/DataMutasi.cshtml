@using static MonPDReborn.Models.DashboardVM
@model MonPDReborn.Models.DashboardVM.DataMutasi

@{
    var currentYear = DateTime.Now.Year;
    var tahun1 = (currentYear - 4).ToString();
    var tahun2 = (currentYear - 3).ToString();
    var tahun3 = (currentYear - 2).ToString();
    var tahun4 = (currentYear - 1).ToString();
    var tahun5 = currentYear.ToString();
}
<div class="table-responsive">
    @(
        Html.DevExtreme().DataGrid<ViewModel.DataMutasi>()
        .ID("dg-Mutasi")
        .ShowBorders(true)
        .ShowColumnHeaders(true)
        .ShowColumnLines(true)
        .ShowRowLines(true)
        .ColumnAutoWidth(true)
        .SearchPanel(s => s.Visible(true).HighlightCaseSensitive(false))
        .AllowColumnResizing(true)
        .DataSource(Model.Data)
        .KeyExpr("ID")
        .Columns(columns =>
        {
            columns.AddFor(x => x.Keterangan).Caption("MUTASI").Alignment(HorizontalAlignment.Left);
            columns.AddFor(x => x.NominalMutasi1).Caption(tahun1).Alignment(HorizontalAlignment.Right).DataType(GridColumnDataType.Number).Format("#,##0");
            columns.AddFor(x => x.NominalMutasi2).Caption(tahun2).Alignment(HorizontalAlignment.Right).DataType(GridColumnDataType.Number).Format("#,##0");
            columns.AddFor(x => x.NominalMutasi3).Caption(tahun3).Alignment(HorizontalAlignment.Right).DataType(GridColumnDataType.Number).Format("#,##0");
            columns.AddFor(x => x.NominalMutasi4).Caption(tahun4).Alignment(HorizontalAlignment.Right).DataType(GridColumnDataType.Number).Format("#,##0");
        })
        .Summary(s =>
        {
            s.TotalItems(items =>
            {
                items.AddFor(x => x.Keterangan)
                .SummaryType(SummaryType.Sum)
                .DisplayFormat("TOTAL");
                
                items.AddFor(x => x.NominalMutasi1)
                .SummaryType(SummaryType.Sum)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}");

                items.AddFor(x => x.NominalMutasi2)
                .SummaryType(SummaryType.Sum)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}");

                items.AddFor(x => x.NominalMutasi3)
                .SummaryType(SummaryType.Sum)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}");

                items.AddFor(x => x.NominalMutasi4)
                .SummaryType(SummaryType.Sum)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}");

                items.AddFor(x => x.NominalMutasi5)
                .SummaryType(SummaryType.Sum)
                .ValueFormat("#,##0")
                .DisplayFormat("{0}");
            });
        })
        )
</div>