@using static MonPDReborn.Models.MonitoringGlobal.MonitoringTahunanVM.MonitoringTahunanViewModels
@model MonPDReborn.Models.MonitoringGlobal.MonitoringTahunanVM.Show


@(Html.DevExtreme().DataGrid<TahunanPajak>()
    .ID("gridLaporanHarian")
    .DataSource(Model.TahunanPajakList)
    .ShowBorders(true)
    .ShowColumnLines(true)
    .ShowRowLines(true)
    .ShowColumnHeaders(true)
    .ColumnAutoWidth(true)
    .Paging(p => p.Enabled(false))
    .SearchPanel(s => s.Visible(true).Placeholder("Search..."))
    .Export(e => e.Enabled(true).AllowExportSelectedData(false).Formats(new[] { "xlsx", "pdf" }))
    .OnExporting("exportGrid")
    .Columns(columns =>
    {
        columns.AddFor(c => c.JenisPajak).Caption("JENIS PAJAK");

        columns.AddFor(c => c.AkpTahun).Caption("AKP 1 TAHUN")
        .Format("#,##0").Alignment(HorizontalAlignment.Right);
        columns.AddFor(c => c.RealisasiHariAccrual).Caption("REALISASI HARI")
        .Format("#,##0").Alignment(HorizontalAlignment.Right);
        columns.AddFor(c => c.RealisasiSDHariAccrual).Caption("REALISASI SAMPAI DENGAN " + Model.tgl.ToString("dd MMM yyyy"))
        .Format("#,##0").Alignment(HorizontalAlignment.Right);
        columns.AddFor(c => c.PersenAccrual).Caption("PERSENTASE").Format(new JS("function(value) { return value.toFixed(2) + ' %'; }"));

    })
    .Summary(s => s
        .TotalItems(t =>
        {
            t.AddFor(c => c.JenisPajak)
                .SummaryType(SummaryType.Sum)
                .DisplayFormat("Total");
                
            t.AddFor(c => c.AkpTahun)
                .SummaryType(SummaryType.Sum)
                .ValueFormat("#,##0")
                .DisplayFormat("Rp. {0}");

            t.AddFor(c => c.RealisasiHariAccrual)
                .SummaryType(SummaryType.Sum)
                .ValueFormat("#,##0")
                .DisplayFormat("Rp. {0}");

            t.AddFor(c => c.RealisasiSDHariAccrual)
                .SummaryType(SummaryType.Sum)
                .ValueFormat("#,##0")
                .DisplayFormat("Rp. {0}");

            t.AddFor(c => c.PersenAccrual)
                .SummaryType(SummaryType.Avg)
                .ValueFormat("#,#0%").DisplayFormat("{0}");

        })
    )
    )