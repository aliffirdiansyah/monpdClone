@using MonPDLib.General
@model MonPDReborn.Models.Reklame.KalkulatorReklameVM.Show

@{
    Layout = null;
}

@using DevExpress.AspNetCore
@using DevExpress.AspNetCore.Reporting
@using DevExpress.XtraReports.Web.WebDocumentViewer

<link rel="stylesheet" href="~/css/reporting.viewer.part.bundle.css" />
<script src="~/js/reporting.viewer.part.bundle.js"></script>

@Html.DevExpress().WebDocumentViewer("DocumentViewer").Height("1000px").Bind(Model.KalkulatorPerPublic)﻿

@* <style>
    body {
        font-family: 'Times New Roman', Times, serif;
        font-size: 14px;
    }

    .table td, .table th {
        vertical-align: middle;
        padding: 4px 8px;
    }

    .judul {
        text-align: center;
        font-weight: bold;
        text-transform: uppercase;
    }

    .section-title {
        font-weight: bold;
        border-bottom: 2px solid black;
        margin-top: 1rem;
    }

    .right {
        text-align: right;
    }
</style>

<div class="container p-4">

    <!-- Header -->
    <div class="text-center mb-4">
        <h5 class="judul">NOTA PERHITUNGAN NILAI SEWA REKLAME</h5>
        <p>
            Berdasarkan Peraturan Walikota Surabaya No. 70 & 71 Tahun 2010
        </p>
    </div>

    <!-- DATA OBYEK PAJAK -->
    <div class="section-title text-center">DATA OBJEK PAJAK</div>
    <table class="table table-bordered border-dark mb-3">
        <tbody>
            <tr>
                <td width="25%">Jenis</td>
                <td class="left">@Model.Output.JenisReklame.GetDescription()</td>
                <td>Sisi</td>
                <td>@Model.Output.Sisi.ToString("N0")</td>
            </tr>
            <tr>
                <td>Panjang</td>
                <td>@Model.Output.Panjang.ToString("N2") M</td>
                <td>Lebar</td>
                <td>@Model.Output.Lebar.ToString("N2")</td>
            </tr>
            <tr>
                <td>Luas</td>
                <td>@Model.Output.Panjang.ToString("N2") × @Model.Output.Lebar.ToString("N2") = @Model.KalkullatorReklameRow.Luas.ToString("N2") M²</td>
                <td>Letak Reklame</td>
                <td>@Model.Output.LetakReklame.GetDescription()</td>
            </tr>
            <tr>
                <td>Ketinggian</td>
                <td>@Model.Output.Tinggi.ToString("N2") M</td>
                <td>Status Lokasi</td>
                <td>@Model.KalkullatorReklameRow.Kawasan.GetDescription()</td>
            </tr>
            <tr>
                <td>Sudut Pandang</td>
                <td>@Model.Output.SudutPandang</td>
                <td>Jenis Produk</td>
                <td>@Model.Output.JenisProduk.GetDescription()</td>
            </tr>
            <tr>
                <td>Nama Jalan</td>
                <td>@Model.KalkullatorReklameRow.NamaJalan</td>
                <td>Kelas Jalan</td>
                <td>@Model.KalkullatorReklameRow.KelasJalan</td>
            </tr>
        </tbody>
    </table>

    <!-- PERHITUNGAN -->
    <div class="section-title text-center">PERHITUNGAN</div>
    <table class="table table-bordered border-dark">
        <tbody>
            <tr class="table-secondary"><td colspan="4" class="fw-bold">NJOP</td></tr>
            <tr>
                <td class="right">Luas</td>
                <td class="right">@Model.KalkullatorReklameRow.Luas.ToString("N2")</td>
                <td class="right">× @Model.KalkullatorReklameRow.NsrLuas.ToString("N0")</td>
                <td class="right">Rp. @Model.KalkullatorReklameRow.NjopLuas.ToString("N0")</td>
            </tr>
            <tr>
                <td class="right">Ketinggian</td>
                <td class="right">@Model.Output.Tinggi.ToString("N2")</td>
                <td class="right">× @Model.KalkullatorReklameRow.NsrKetinggian.ToString("N0")</td>
                <td class="right">Rp. @Model.KalkullatorReklameRow.NjopKetinggian.ToString("N0")</td>
            </tr>
            <tr>
                <td colspan="3" class="fw-bold right">TOTAL NJOP</td>
                <td class="right fw-bold">Rp. @Model.KalkullatorReklameRow.TotalNjop.ToString("N0")</td>
            </tr>

            <tr class="table-secondary">
                <td colspan="4" class="fw-bold">NILAI STRATEGIS</td>
            </tr>

            <tr>
                <td class="right">Skor Lokasi</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.SkorLokasi.ToString("N2") × @Model.KalkullatorReklameRow.BobotLokasiNilai.ToString("P2")
                </td>
                <td class="text-end">
                    @Model.KalkullatorReklameRow.HasilNssLokasi.ToString("N2")
                </td>
            </tr>

            <tr>
                <td class="right">Skor Sudut Pandang</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.SkorPandang.ToString("N2") × @Model.KalkullatorReklameRow.BobotPandangNilai.ToString("P2")
                </td>
                <td class="text-end">
                    @Model.KalkullatorReklameRow.HasilNssPandang.ToString("N2")
                </td>
            </tr>

            <tr>
                <td class="right">Skor Ketinggian</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.SkorKetinggian.ToString("N2") × @Model.KalkullatorReklameRow.BobotKetinggianNilai.ToString("P2")
                </td>
                <td class="text-end">
                    @Model.KalkullatorReklameRow.HasilNssKetinggian.ToString("N2")
                </td>
            </tr>

            <tr>
                <td class="right">BOBOT TOTAL</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.TotalSkor.ToString("N2") × @Model.KalkullatorReklameRow.Nss.ToString("N0")
                </td>
                <td class="text-end">
                    Rp. @Model.KalkullatorReklameRow.TotalNilaiStrategis.ToString("N0")
                </td>
            </tr>

            <tr>
                <td class="fw-bold right">Total NJOP + Nilai Strategis</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.TotalNjop.ToString("N0") + @Model.KalkullatorReklameRow.TotalNilaiStrategis.ToString("N0")
                </td>
                <td class="text-end">
                   Rp. @Model.KalkullatorReklameRow.TotalNjopStrategis.ToString("N2")
                </td>
            </tr>

            <tr>
                <td class="fw-bold text-end">Total NJOP + Nilai Strategis</td>
                <td colspan="2" class="fw-bold text-end">
                    @Model.KalkullatorReklameRow.TotalNjop.ToString("N0") + @Model.KalkullatorReklameRow.TotalNilaiStrategis.ToString("N0")
                </td>
                <td class="fw-bold text-end">
                    Rp. @Model.KalkullatorReklameRow.TotalNjopStrategis.ToString("N0")
                </td>
            </tr>

            <tr>
                <td class="fw-bold text-end">Penambahan Ketinggian</td>
                @if (Model.Output.Tinggi >= 16)
                {
                    <td colspan="2" class="right">@Model.KalkullatorReklameRow.TotalNjopStrategis.ToString("N0") × @Model.KalkullatorReklameRow.PersenTambahKetinggian.ToString("P2")</td>
                }
                else
                {
                    <td colspan="2"></td>
                }
                <td class="fw-bold text-end">
                    Rp. @Model.KalkullatorReklameRow.PenambahanKetinggian.ToString("N0")
                </td>
            </tr>

            <tr class="table-secondary"><td colspan="4" class="fw-bold">POKOK PAJAK</td></tr>
            <tr>
                <td class="right">Pokok Pajak</td>
                <td colspan="2" class="right">@Model.KalkullatorReklameRow.TotalAfterKetinggian.ToString("N0") × 25%</td>
                <td class="right">Rp. @Model.KalkullatorReklameRow.PokokPajak.ToString("N0")</td>
            </tr>
            <tr>
                <td class="right">Produk Rokok</td>
                @if (Model.Output.JenisProduk == EnumFactory.ProdukReklame.Rokok)
                {
                    <td class="right" colspan="2">
                        @Model.KalkullatorReklameRow.PokokPajak.ToString("N0")  × 25%
                    </td>
                }
                else
                {
                    <td colspan="2"></td>
                }
                <td class="right">Rp. @Model.KalkullatorReklameRow.ProdukRokok.ToString("N0")</td>
            </tr>
            @{
                decimal totalSebelumSisi = Model.KalkullatorReklameRow.TotalNilaiSewa;
                if (Model.Output.Sisi > 1)
                {
                    totalSebelumSisi = Model.KalkullatorReklameRow.TotalNilaiSewa / Model.Output.Sisi;
                }
            }

        </tbody>
    </table>

    <div class="section-title text-center">HASIL PERHITUNGAN</div>
    <table class="table table-bordered border-dark">
        <tbody>
            <tr>
                <td class="right fw-bold">Total Nilai Sewa Reklame</td>
                <td colspan="2" class="right">@(Model.Output.Sisi > 1 ? $"{totalSebelumSisi.ToString("N0")} × {Model.Output.Sisi} " : "")</td>
                <td class="right fw-bold">Rp. @Model.KalkullatorReklameRow.TotalNilaiSewa.ToString("N0")</td>
            </tr>

            <tr class="table-secondary"><td colspan="4" class="fw-bold">JAMINAN BONGKAR</td></tr> 
            <tr>
                <td class="right fw-bold">Jaminan Bongkar</td>
                <td colspan="2" class="right">@Model.KalkullatorReklameRow.Luas.ToString("N2") × 50,000 @(Model.Output.Sisi > 1 ? $" × {Model.Output.Sisi} " : "")</td>
                <td class="right">Rp. @Model.KalkullatorReklameRow.JaminanBongkar.ToString("N0")</td>
            </tr>
        </tbody>
    </table>

    <p class="mt-4">
        Keterangan : <br />
        <ul>
            <li>
                Estimasi ini hanya bersifat simulasi. Nilai pajak sesungguhnya akan ditentukan berdasarkan pemeriksaan oleh petugas sesuai data dan ketentuan yang berlaku.<br />

            </li>
            <li>
                Jambong hanya dikenakan untuk reklame yang diselenggarakan di atas tanah, bangunan, atau barang milik/yang dikuasai oleh Pemerintah Kota Surabaya.

            </li>
        </ul>
    </p>
</div> *@
