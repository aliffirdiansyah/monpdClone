@using MonPDLib.General
@model MonPDReborn.Models.Reklame.KakulatorReklameVM.Show

@{
    Layout = null;
}

<style>
    body {
        font-family: "Courier New", monospace;
        font-size: 14px;
    }

    .table td, .table th {
        vertical-align: middle;
        padding: 4px 8px;
    }

    .judul {
        text-align: center;
        font-weight: bold;
        text-transform: uppercase;
    }

    .section-title {
        font-weight: bold;
        border-bottom: 2px solid black;
        margin-top: 1rem;
    }

    .right {
        text-align: right;
    }
</style>

<div class="container p-4">

    <!-- Header -->
    <div class="text-center mb-4">
        <h5 class="judul">NOTA PERHITUNGAN NILAI SEWA REKLAME</h5>
        <p>
            Alamat Penempatan : ..............................................<br />
            Berdasarkan Peraturan Walikota Surabaya No. 70 & 71 Tahun 2010
        </p>
    </div>

    <!-- DATA OBYEK PAJAK -->
    <div class="section-title text-center">DATA OBJEK PAJAK</div>
    <table class="table table-bordered border-dark mb-3">
        <tbody>
            <tr>
                <td width="25%">Jenis</td>
                <td class="left" colspan="3">@Model.Output.JenisReklame.GetDescription()</td>
            </tr>
            <tr>
                <td>Panjang</td>
                <td>@Model.Output.Panjang</td>
                <td>Sisi</td>
                <td>1</td>
            </tr>
            <tr>
                <td>Luas</td>
                <td>@Model.Output.Panjang × @Model.Output.Lebar = @Model.KalkullatorReklameRow.Luas</td>
                <td>Letak Reklame</td>
                <td>@Model.Output.LetakReklame.GetDescription()</td>
            </tr>
            <tr>
                <td>Ketinggian</td>
                <td>@Model.Output.Tinggi</td>
                <td>Status Lokasi</td>
                <td>@Model.KalkullatorReklameRow.Kawasan.GetDescription()</td>
            </tr>
            <tr>
                <td>Sudut Pandang</td>
                <td>@Model.Output.SudutPandang</td>
                <td>Jenis Produk</td>
                <td>@Model.Output.JenisProduk.GetDescription()</td>
            </tr>
            <tr>
                <td>Nama Jalan</td>
                <td>@Model.KalkullatorReklameRow.NamaJalan</td>
                <td>Kelas Jalan</td>
                <td>@Model.KalkullatorReklameRow.KelasJalan</td>
            </tr>
        </tbody>
    </table>

    <!-- PERHITUNGAN -->
    <div class="section-title text-center">PERHITUNGAN</div>
    <table class="table table-bordered border-dark">
        <tbody>
            <tr class="table-secondary"><td colspan="4" class="fw-bold">NJOP</td></tr>
            <tr>
                <td class="right">Luas</td>
                <td class="right">@Model.KalkullatorReklameRow.Luas</td>
                <td class="right">× @Model.KalkullatorReklameRow.NsrLuas.ToString("N0")</td>
                <td class="right">Rp. @Model.KalkullatorReklameRow.NjopLuas.ToString("N0")</td>
            </tr>
            <tr>
                <td class="right">Ketinggian</td>
                <td class="right">@Model.Output.Tinggi</td>
                <td class="right">× @Model.KalkullatorReklameRow.NsrKetinggian.ToString("N0")</td>
                <td class="right">Rp. @Model.KalkullatorReklameRow.NjopKetinggian.ToString("N0")</td>
            </tr>
            <tr>
                <td colspan="3" class="fw-bold right">TOTAL NJOP</td>
                <td class="right fw-bold">Rp. @Model.KalkullatorReklameRow.TotalNjop.ToString("N0")</td>
            </tr>

            <tr class="table-secondary">
                <td colspan="4" class="fw-bold">NILAI STRATEGIS</td>
            </tr>

            <tr>
                <td class="right">Skor Lokasi</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.SkorLokasi.ToString("N2") × @Model.KalkullatorReklameRow.BobotLokasiNilai.ToString("P2")
                </td>
                <td class="text-end">
                    @Model.KalkullatorReklameRow.HasilNssLokasi.ToString("N2")
                </td>
            </tr>

            <tr>
                <td class="right">Skor S. Pandang</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.SkorPandang.ToString("N2") × @Model.KalkullatorReklameRow.BobotPandangNilai.ToString("P2")
                </td>
                <td class="text-end">
                    @Model.KalkullatorReklameRow.HasilNssPandang.ToString("N2")
                </td>
            </tr>

            <tr>
                <td class="right">Skor Ketinggian</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.SkorKetinggian.ToString("N2") × @Model.KalkullatorReklameRow.BobotKetinggianNilai.ToString("P2")
                </td>
                <td class="text-end">
                    @Model.KalkullatorReklameRow.HasilNssKetinggian.ToString("N2")
                </td>
            </tr>

            <tr>
                <td class="right">BOBOT TOTAL</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.TotalSkor.ToString("N2") × @Model.KalkullatorReklameRow.Nss.ToString("N0")
                </td>
                <td class="text-end">
                   Rp. @Model.KalkullatorReklameRow.TotalNilaiStrategis.ToString("N0")
                </td>
            </tr>

           @*  <tr>
                <td class="fw-bold right">Total NJOP + Nilai Strategis</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.TotalNjop.ToString("N0") + @Model.KalkullatorReklameRow.TotalNilaiStrategis.ToString("N0")
                </td>
                <td class="text-end">
                   Rp. @Model.KalkullatorReklameRow.TotalNjopStrategis.ToString("N2")
                </td>
            </tr> *@

            <tr>
                <td class="fw-bold text-end">Total NJOP + Nilai Strategis</td>
                <td colspan="2" class="text-end">
                    @Model.KalkullatorReklameRow.TotalNjop.ToString("N0") + @Model.KalkullatorReklameRow.TotalNilaiStrategis.ToString("N0")
                </td>
                <td class="fw-bold text-end">
                    Rp. @Model.KalkullatorReklameRow.TotalNjopStrategis.ToString("N0")
                </td>
            </tr>

            <tr>
                <td class="fw-bold text-end">Penambahan Ketinggian</td>
                <td colspan="2" class="right">@Model.Output.Tinggi.ToString("N2") × @Model.KalkullatorReklameRow.PersenTambahKetinggian.ToString("P2")</td>
                <td class="fw-bold text-end">
                    Rp. @Model.KalkullatorReklameRow.PenambahanKetinggian.ToString("N0")
                </td>
            </tr>


            <tr class="table-secondary"><td colspan="4" class="fw-bold">POKOK PAJAK</td></tr>
            <tr>
                <td class="right">Pokok Pajak</td>
                <td colspan="2" class="right">@Model.KalkullatorReklameRow.TotalAfterKetinggian.ToString("N0") × 25%</td>
                <td class="right">Rp. @Model.KalkullatorReklameRow.PokokPajak.ToString("N0")</td>
            </tr>
            <tr>
                <td class="right">Produk Rokok</td>
                @if (Model.Output.JenisProduk == EnumFactory.ProdukReklame.Rokok)
                {
                    <td class="right" colspan="2">
                        @Model.KalkullatorReklameRow.PokokPajak.ToString("N0")  × 25%
                    </td>
                }
                else
                {
                    <td colspan="2"></td>
                }
                <td class="right">Rp. @Model.KalkullatorReklameRow.ProdukRokok.ToString("N0")</td>
            </tr>
            <tr>
                <td colspan="3" class="fw-bold right">Total Nilai Sewa Reklame</td>
                <td class="right fw-bold">Rp. @Model.KalkullatorReklameRow.TotalNilaiSewa.ToString("N0")</td>
            </tr>

            <tr class="table-secondary"><td colspan="4" class="fw-bold">JAMINAN BONGKAR</td></tr>
            <tr>
                <td class="right">Jaminan Bongkar</td>
                <td colspan="2" class="right">@Model.KalkullatorReklameRow.Luas.ToString("N2") × 50,000</td>
                <td class="right">Rp. @Model.KalkullatorReklameRow.JaminanBongkar.ToString("N0")</td>
            </tr>
        </tbody>
    </table>

    <p class="mt-4">Keterangan : ...........................................................................................................</p>
    @* 
    <div class="text-end mt-5">
        Surabaya, @DateTime.Now.ToString("dd - MM - yyyy")<br /><br />
        <b>Agung Pambudi, SE</b><br />
        NIP. 19751115 200501 1 011
    </div>
 *@
</div>
