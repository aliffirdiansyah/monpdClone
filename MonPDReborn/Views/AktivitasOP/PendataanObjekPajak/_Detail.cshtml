@using MonPDReborn.Models.AktivitasOP
@model PendataanObjekPajakVM.Detail

@if (Model.DataDetailList?.Any() == true)
{
    <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="d-flex align-items-center">
            <i class=" mdi mdi-file-document-outline" style="font-size: 20px; line-height: 1;"></i>
            <h6 class="mb-0 fs-16 fw-bold">
                @Model.DataDetailList.First().JenisPajak
            </h6>
        </div>
    </div>
   
}
<div class="table-responsive">
    @(Html.DevExtreme().DataGrid<PendataanObjekPajakVM.DataDetailPendataan>()
    .ID("gridPendataanDetail")
    .DataSource(Model.DataDetailList)
    .ShowBorders(true)
    .ShowColumnLines(true)
    .ShowColumnHeaders(true)
    .AllowColumnResizing(true)
    .ShowRowLines(true)
    .ColumnAutoWidth(true)
    .SearchPanel(s => s.Visible(true).HighlightCaseSensitive(false))
    .FilterRow(f => f.Visible(true))
    .HeaderFilter(h => h.Visible(true))
    .Sorting(s => s.Mode(GridSortingMode.Multiple))
    .Paging(p => p.PageSize(10))
    .Pager(pager =>
    {
        pager.ShowPageSizeSelector(true);
        pager.AllowedPageSizes(new[] { 10, 20, 50 });
        pager.ShowInfo(true);
    })
    .Export(e => e.Enabled(true).AllowExportSelectedData(false).Formats(new[] { "xlsx", "pdf" }))
    .OnExporting("exportGrid")
    .Columns(columns => {
        columns.AddFor(m => m.FormattedNOP).Caption("NOP");
        columns.AddFor(m => m.ObjekPajak).Caption("Objek Pajak");
        columns.AddFor(m => m.Alamat).Caption("Alamat");
        columns.AddFor(m => m.Omzet).Caption("Omzet").Format("#,##0");
        columns.AddFor(m => m.PajakBulanan).Caption("Pajak Bulanan").Format("#,##0");
        columns.AddFor(m => m.AvgRealisasi).Caption("Rata-Rata Realisasi").Format("#,##0");
        columns.AddFor(m => m.Selisih).Caption("Selisih").Format("#,##0");
        columns.Add()
            .Type(GridCommandColumnType.Buttons)
            .Buttons(b => {
                b.Add()
                .Text("Detail")
                .Icon("search")
                .OnClick("onDetailClick");
            });
    })
    .Summary(s =>
    {
        // Summary di footer
        s.TotalItems(items =>
        {
            items.AddFor(m => m.Alamat)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .Alignment(HorizontalAlignment.Right)
            .DisplayFormat("TOTAL");
            
            items.AddFor(m => m.Omzet)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

            items.AddFor(m => m.PajakBulanan)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

            items.AddFor(m => m.AvgRealisasi)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

            items.AddFor(m => m.Selisih)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");
        });

    })
)
</div>

