@using MonPDReborn.Models.AktivitasOP
@model MonPDReborn.Models.AktivitasOP.SeriesPendapatanDaerahUrgentVM.Index

@{
    int year1 = DateTime.Now.Year;
    int year2 = year1 - 1;
    int year3 = year1 - 2;
    int year4 = year1 - 3;
    int year5 = year1 - 4;
    int year6 = year1 - 5;
    int year7 = year1 - 6;
}

<p style="font-weight: bold; margin-bottom: 5px;">Akun</p>
@(
Html.DevExtreme().DataGrid<SeriesPendapatanDaerahUrgentVM.ViewModel.ShowSeriesSudutPandangRekening.Akun>()
    .ID("dg-SudutPandangRekening")
    .DataSource(Model.SudutPandangRekening)
    .KeyExpr("Col.Kode")
    .ShowBorders(true)
    .ShowColumnHeaders(true)
    .ShowColumnLines(true)
    .ShowRowLines(true)

    // Enable sorting & filtering
    .AllowColumnResizing(true)
    .AllowColumnReordering(true)
    .ColumnAutoWidth(true)

    .Sorting(s => s.Mode(GridSortingMode.Multiple))
    .FilterRow(f => f
        .Visible(true)
        .ApplyFilter(GridApplyFilterMode.Auto)  // Bisa juga OnClick
    )
    .Paging(p => p.PageSize(999999))
    .Pager(p => p.Visible(false))
    .HeaderFilter(hf => hf.Visible(true))
    .Columns(columns => {
        columns.AddFor(m => m.Col.Nama).Caption("Nama");

        columns.Add().Caption(year7.ToString())
            .Columns(sc =>
            {
                sc.AddFor(m => m.Col.TargetTahun7).Caption("Target").Format("#,##0");
                sc.AddFor(m => m.Col.RealisasiTahun7).Caption("Realisasi").Format("#,##0");
                sc.AddFor(m => m.Col.PersentaseTahun7).Caption("%").Format("#,##0.##'%'");
            });

        columns.Add().Caption(year6.ToString())
            .Columns(sc =>
            {
                sc.AddFor(m => m.Col.TargetTahun6).Caption("Target").Format("#,##0");
                sc.AddFor(m => m.Col.RealisasiTahun6).Caption("Realisasi").Format("#,##0");
                sc.AddFor(m => m.Col.PersentaseTahun6).Caption("%").Format("#,##0.##'%'");
            });

        columns.Add().Caption(year5.ToString())
            .Columns(sc =>
            {
                sc.AddFor(m => m.Col.TargetTahun5).Caption("Target").Format("#,##0");
                sc.AddFor(m => m.Col.RealisasiTahun5).Caption("Realisasi").Format("#,##0");
                sc.AddFor(m => m.Col.PersentaseTahun5).Caption("%").Format("#,##0.##'%'");
            });

        columns.Add().Caption(year4.ToString())
            .Columns(sc =>
            {
                sc.AddFor(m => m.Col.TargetTahun4).Caption("Target").Format("#,##0");
                sc.AddFor(m => m.Col.RealisasiTahun4).Caption("Realisasi").Format("#,##0");
                sc.AddFor(m => m.Col.PersentaseTahun4).Caption("%").Format("#,##0.##'%'");
            });

        columns.Add().Caption(year3.ToString())
            .Columns(sc =>
            {
                sc.AddFor(m => m.Col.TargetTahun3).Caption("Target").Format("#,##0");
                sc.AddFor(m => m.Col.RealisasiTahun3).Caption("Realisasi").Format("#,##0");
                sc.AddFor(m => m.Col.PersentaseTahun3).Caption("%").Format("#,##0.##'%'");
            });

        columns.Add().Caption(year2.ToString())
            .Columns(sc =>
            {
                sc.AddFor(m => m.Col.TargetTahun2).Caption("Target").Format("#,##0");
                sc.AddFor(m => m.Col.RealisasiTahun2).Caption("Realisasi").Format("#,##0");
                sc.AddFor(m => m.Col.PersentaseTahun2).Caption("%").Format("#,##0.##'%'");
            });

        columns.Add().Caption(year1.ToString())
            .Columns(sc =>
            {
                sc.AddFor(m => m.Col.TargetTahun1).Caption("Target").Format("#,##0");
                sc.AddFor(m => m.Col.RealisasiTahun1).Caption("Realisasi").Format("#,##0");
                sc.AddFor(m => m.Col.PersentaseTahun1).Caption("%").Format("#,##0.##'%'");
            });
    })
    .MasterDetail(md => md
    .Enabled(true)
    .Template(new JS("SudutPandangRekeningKelompok"))
    )
)


@section Scripts{
        <script>
        var year1 = new Date().getFullYear();
        var year2 = year1 - 1;
        var year3 = year1 - 2;
        var year4 = year1 - 3;
        var year5 = year1 - 4;
        var year6 = year1 - 5;
        var year7 = year1 - 6;
        </script>

    <script>
        function SudutPandangRekeningKelompok(container, options) {
            var data = options.data.RekKelompoks;
            var $wrapper = $("<div>").appendTo(container);

            $("<p>")
                .text("Kelompok")
                .css({ "font-weight": "bold", "margin-bottom": "5px" })
                .appendTo($wrapper);
            $("<div>")
                .appendTo($wrapper)
                .dxDataGrid({
                    dataSource: data,
                    showBorders: true,
                    showColumnHeaders: true,
                    showColumnLines: true,
                    showRowLines: true,
                    allowColumnResizing: true,
                    allowColumnReordering: true,
                    columnAutoWidth: true,
                    sorting: { mode: "multiple" }, // Multiple column sorting
                    filterRow: {
                        visible: true,
                        applyFilter: "auto" // atau "onClick"
                    },
                    headerFilter: { visible: true },
                    paging: { pageSize: 99999 },
                    pager: { visible: false  },
                    columns: [
                        { dataField: "Col.Nama", caption: "Nama" },
                        {
                        caption: year7.toString(),
                        columns: [
                                { dataField: "Col.TargetTahun7", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun7", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun7", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year6.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun6", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun6", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun6", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year5.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun5", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun5", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun5", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year4.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun4", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun4", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun4", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year3.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun3", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun3", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun3", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year2.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun2", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun2", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun2", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year1.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun1", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun1", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun1", caption: "%", format: "#,#0%" }
                            ]
                        }
                    ],
                    masterDetail: {
                        enabled: true,
                        template: SudutPandangRekeningJenis
                    },
                    width: "100%"
                })
        }

        function SudutPandangRekeningJenis(container, options) {
            var data = options.data.RekJeniss;
            var $wrapper = $("<div>").appendTo(container);
            $("<p>")
                .text("Jenis")
                .css({ "font-weight": "bold", "margin-bottom": "5px" })
                .appendTo($wrapper);
            $("<div>")
                .appendTo($wrapper)
                .dxDataGrid({
                    dataSource: data,
                    showBorders: true,
                    showColumnHeaders: true,
                    showColumnLines: true,
                    showRowLines: true,
                    allowColumnResizing: true,
                    allowColumnReordering: true,
                    columnAutoWidth: true,
                    sorting: { mode: "multiple" }, // Multiple column sorting
                    filterRow: {
                        visible: true,
                        applyFilter: "auto" // atau "onClick"
                    },
                    headerFilter: { visible: true },
                    paging: { pageSize: 99999 },
                    pager: { visible: false  },
                    columns: [
                        { dataField: "Col.Nama", caption: "Nama" },
                        {
                        caption: year7.toString(),
                        columns: [
                                { dataField: "Col.TargetTahun7", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun7", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun7", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year6.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun6", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun6", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun6", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year5.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun5", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun5", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun5", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year4.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun4", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun4", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun4", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year3.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun3", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun3", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun3", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year2.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun2", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun2", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun2", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year1.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun1", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun1", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun1", caption: "%", format: "#,#0%" }
                            ]
                        }
                    ],
                    masterDetail: {
                        enabled: true,
                        template: SudutPandangRekeningObjek
                    },
                    width: "100%"
                })
        }

        function SudutPandangRekeningObjek(container, options) {
            var data = options.data.RekObjeks;
            var $wrapper = $("<div>").appendTo(container);
            $("<p>")
                .text("Objek")
                .css({ "font-weight": "bold", "margin-bottom": "5px" })
                .appendTo($wrapper);
            $("<div>")
                .appendTo($wrapper)
                .dxDataGrid({
                    dataSource: data,
                    showBorders: true,
                    showColumnHeaders: true,
                    showColumnLines: true,
                    showRowLines: true,
                    allowColumnResizing: true,
                    allowColumnReordering: true,
                    columnAutoWidth: true,
                    sorting: { mode: "multiple" }, // Multiple column sorting
                    filterRow: {
                        visible: true,
                        applyFilter: "auto" // atau "onClick"
                    },
                    headerFilter: { visible: true },
                    paging: { pageSize: 99999 },
                    pager: { visible: false  },
                    columns: [
                        { dataField: "Col.Nama", caption: "Nama" },
                        {
                        caption: year7.toString(),
                        columns: [
                                { dataField: "Col.TargetTahun7", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun7", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun7", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year6.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun6", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun6", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun6", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year5.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun5", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun5", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun5", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year4.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun4", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun4", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun4", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year3.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun3", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun3", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun3", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year2.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun2", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun2", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun2", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year1.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun1", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun1", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun1", caption: "%", format: "#,#0%" }
                            ]
                        }
                    ],
                    masterDetail: {
                        enabled: true,
                        template: SudutPandangRekeningRincian
                    },
                    width: "100%"
                })
        }

        function SudutPandangRekeningRincian(container, options) {
            var data = options.data.RekRincians;
            var $wrapper = $("<div>").appendTo(container);
            $("<p>")
                .text("Rincian")
                .css({ "font-weight": "bold", "margin-bottom": "5px" })
                .appendTo($wrapper);
            $("<div>")
                .appendTo($wrapper)
                .dxDataGrid({
                    dataSource: data,
                    showBorders: true,
                    showColumnHeaders: true,
                    showColumnLines: true,
                    showRowLines: true,
                    allowColumnResizing: true,
                    allowColumnReordering: true,
                    columnAutoWidth: true,
                    sorting: { mode: "multiple" }, // Multiple column sorting
                    filterRow: {
                        visible: true,
                        applyFilter: "auto" // atau "onClick"
                    },
                    headerFilter: { visible: true },
                    paging: { pageSize: 99999 },
                    pager: { visible: false  },
                    columns: [
                        { dataField: "Col.Nama", caption: "Nama" },
                        {
                        caption: year7.toString(),
                        columns: [
                                { dataField: "Col.TargetTahun7", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun7", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun7", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year6.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun6", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun6", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun6", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year5.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun5", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun5", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun5", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year4.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun4", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun4", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun4", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year3.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun3", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun3", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun3", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year2.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun2", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun2", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun2", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year1.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun1", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun1", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun1", caption: "%", format: "#,#0%" }
                            ]
                        }
                    ],
                    masterDetail: {
                        enabled: true,
                        template: SudutPandangRekeningSubRincian
                    },
                    width: "100%"
                })
        }

        function SudutPandangRekeningSubRincian(container, options) {
            var data = options.data.RekSubRincians;
            var $wrapper = $("<div>").appendTo(container);
            $("<p>")
                .text("Subrincian")
                .css({ "font-weight": "bold", "margin-bottom": "5px" })
                .appendTo($wrapper);
            $("<div>")
                .appendTo($wrapper)
                .dxDataGrid({
                    dataSource: data,
                    showBorders: true,
                    showColumnHeaders: true,
                    showColumnLines: true,
                    showRowLines: true,
                    allowColumnResizing: true,
                    allowColumnReordering: true,
                    columnAutoWidth: true,
                    sorting: { mode: "multiple" }, // Multiple column sorting
                    filterRow: {
                        visible: true,
                        applyFilter: "auto" // atau "onClick"
                    },
                    headerFilter: { visible: true },
                    paging: { pageSize: 99999 },
                    pager: { visible: false  },
                    columns: [
                        { dataField: "Col.Nama", caption: "Nama" },
                        {
                        caption: year7.toString(),
                        columns: [
                                { dataField: "Col.TargetTahun7", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun7", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun7", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year6.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun6", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun6", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun6", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year5.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun5", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun5", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun5", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year4.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun4", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun4", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun4", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year3.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun3", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun3", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun3", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year2.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun2", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun2", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun2", caption: "%", format: "#,#0%" }
                            ]
                        },
                        {
                            caption: year1.toString(),
                            columns: [
                                { dataField: "Col.TargetTahun1", caption: "Target", format: "#,##0" },
                                { dataField: "Col.RealisasiTahun1", caption: "Realisasi", format: "#,##0" },
                                { dataField: "Col.PersentaseTahun1", caption: "%", format: "#,#0%" }
                            ]
                        }
                    ],
                    width: "100%"
                })
        }
    </script>
}