@{
    var currentYear = DateTime.Now.Year;
    var tahun1 = (currentYear - 4).ToString();
    var tahun2 = (currentYear - 3).ToString();
    var tahun3 = (currentYear - 2).ToString();
    var tahun4 = (currentYear - 1).ToString();
    var tahun5 = currentYear.ToString();
}
<div class="table-responsive">
    @(
        Html.DevExtreme().DataGrid<MonPDReborn.Models.AktivitasOP.PemasanganAlatVM.DetailSeriesPemasanganAlat>()
        .DataSource(d => d.Mvc()
        .LoadAction("GetDetailSeries")
        .Key("KategoriId")
        .LoadParams(new { JenisPajak = ViewData["JenisPajak"] })
        )
        .ShowColumnLines(true)
        .ShowRowLines(true)
        .ShowBorders(true)
        .ShowColumnHeaders(true)
        .ColumnAutoWidth(true)
        .RowAlternationEnabled(true)
        .Columns(columns =>
        {
            columns.AddFor(x => x.KategoriNama).Caption("Kategori").Fixed(true);
            columns.AddFor(x => x.JumlahOP).Caption("Jumlah OP").Format("#,##0");

            columns.Add().Caption(tahun1).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2021).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.Add().Caption(tahun2).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2022).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.Add().Caption(tahun3).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2023).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.Add().Caption(tahun4).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2024).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.Add().Caption(tahun5).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2025).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.AddFor(x => x.BelumTerpasang2025).Caption("Belum Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            columns.AddFor(x => x.TotalTerpasang).Caption("Total Terpasang").Format("#,##0");
        })
        .Summary(summary =>
        {
            summary.TotalItems(items =>
            {
                items.AddFor(x => x.KategoriNama).SummaryType(SummaryType.Sum).DisplayFormat("Total");

                items.AddFor(x => x.JumlahOP).SummaryType(SummaryType.Sum).ValueFormat("#,##0").DisplayFormat("{0}");

                items.AddFor(x => x.Terpasang2021).SummaryType(SummaryType.Sum).ValueFormat("#,##0") .DisplayFormat("{0}");

                items.AddFor(x => x.Terpasang2022).SummaryType(SummaryType.Sum).ValueFormat("#,##0") .DisplayFormat("{0}");

                items.AddFor(x => x.Terpasang2023).SummaryType(SummaryType.Sum).ValueFormat("#,##0") .DisplayFormat("{0}");

                items.AddFor(x => x.Terpasang2024).SummaryType(SummaryType.Sum).ValueFormat("#,##0") .DisplayFormat("{0}");

                items.AddFor(x => x.Terpasang2025).SummaryType(SummaryType.Sum).ValueFormat("#,##0") .DisplayFormat("{0}");
                items.AddFor(x => x.BelumTerpasang2025).SummaryType(SummaryType.Sum).ValueFormat("#,##0") .DisplayFormat("{0}");                
                items.AddFor(x => x.TotalTerpasang).SummaryType(SummaryType.Sum).ValueFormat("#,##0") .DisplayFormat("{0}");

            });
        })
        )
</div>
 