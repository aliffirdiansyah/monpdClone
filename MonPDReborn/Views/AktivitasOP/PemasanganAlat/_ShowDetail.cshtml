@{
    var currentYear = DateTime.Now.Year;
    var tahun1 = (currentYear - 4).ToString();
    var tahun2 = (currentYear - 3).ToString();
    var tahun3 = (currentYear - 2).ToString();
    var tahun4 = (currentYear - 1).ToString();
    var tahun5 = currentYear.ToString();
}
<div class="table-responsive">
    @(
        Html.DevExtreme().DataGrid<MonPDReborn.Models.AktivitasOP.PemasanganAlatVM.DetailSeriesPemasanganAlat>()
        .DataSource(d => d.Mvc()
        .LoadAction("GetDetailSeries")
        .Key("KategoriId")
        .LoadParams(new { JenisPajak = ViewData["JenisPajak"] })
        )
        .ShowColumnLines(true)
        .ShowRowLines(true)
        .ShowBorders(true)
        .ShowColumnHeaders(true)
        .ColumnAutoWidth(true)
        .RowAlternationEnabled(true)
        .Columns(columns =>
        {
            columns.AddFor(x => x.KategoriNama).Caption("Kategori").Fixed(true);
            columns.AddFor(x => x.JumlahOP).Caption("Jumlah OP").Format("#,##0");

            columns.Add().Caption("Terapasang").Columns(sub =>
            {
                sub.AddFor(m => m.TahunMines4).Caption(tahun1).Format("#,##0");
                sub.AddFor(m => m.TahunMines3).Caption(tahun2).Format("#,##0");
                sub.AddFor(m => m.TahunMines2).Caption(tahun3).Format("#,##0");
                sub.AddFor(m => m.TahunMines1).Caption(tahun4).Format("#,##0");
                sub.AddFor(m => m.TahunNow).Caption(tahun5).Format("#,##0");
            });

            columns.AddFor(m => m.TotalTerpasang).Caption("Total Terpassang").Format("#,##0");
            columns.AddFor(m => m.BelumTahunNow).Caption("Belum Terpasang").Format("#,##0");

            @* columns.Add().Caption(tahun1).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2021).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.Add().Caption(tahun2).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2022).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.Add().Caption(tahun3).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2023).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.Add().Caption(tahun4).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2024).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.Add().Caption(tahun5).Alignment(HorizontalAlignment.Center).Columns(sub =>
            {
                sub.AddFor(x => x.Terpasang2025).Caption("Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate"));
            });
            columns.AddFor(x => x.TotalTerpasang).Caption("Total Terpasang").Format("#,##0");
            columns.AddFor(x => x.BelumTerpasang2025).Caption("Belum Terpasang").Format("#,##0").CellTemplate(new JS("kategoriSeriesCellTemplate")); *@
        })
        .Summary(summary =>
        {
            summary.TotalItems(items =>
            {
                items.AddFor(m => m.KategoriNama)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("Total");

                items.AddFor(m => m.JumlahOP)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

                items.AddFor(m => m.TahunMines4)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

                items.AddFor(m => m.TahunMines3)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

                items.AddFor(m => m.TahunMines2)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

                items.AddFor(m => m.TahunMines1)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

                items.AddFor(m => m.TahunNow)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

                items.AddFor(m => m.TotalTerpasang)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

                items.AddFor(m => m.BelumTahunNow)
            .SummaryType(SummaryType.Sum)
            .ValueFormat("#,##0")
            .DisplayFormat("{0}");

            });
        })
        )
</div>
 