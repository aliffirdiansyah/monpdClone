@using MonPDReborn.Models.AktivitasOP
@model PemeriksaanPajakVM.Show

<div class="table-responsive">
    @(Html.DevExtreme().DataGrid<PemeriksaanPajakVM.DataPemeriksaan>()
        .ID("gridPemeriksaanPajak")
        .DataSource(Model.DataPemeriksaanList)
        .KeyExpr("JenisPajak")
        .ShowBorders(true)
        .ShowColumnLines(true)
        .ColumnAutoWidth(true)
        .HeaderFilter(h => h.Visible(true))

        .FilterRow(f => f
        .Visible(true)       // Tampilkan filter row
        .ApplyFilter(GridApplyFilterMode.Auto) // Filter otomatis saat ketik
        )
        .Columns(columns =>
        {
            columns.AddFor(m => m.JenisPajak)
            .Caption("JENIS PAJAK")
            .Fixed(true);

            columns.Add()
            .Caption("JUMLAH OP YANG DIPERIKSA")
            .Alignment(HorizontalAlignment.Center)
            .Columns(sub =>
            {
                sub.Add().DataField("JumlahOP2023").Caption("2023").Alignment(HorizontalAlignment.Center)
                .CellTemplate(@<text>
                    <div style="display: flex; align-items: center; justify-content: flex-end;">
                        <a href="javascript:void(0);"
                            class="value-link text-decoration-none"
                            onclick="onDetailPemeriksaanClick('<%- data.JenisPajak %>', 2023)"
                            title="Lihat Detail Pemeriksaan 2023">
                            <%- (value || 0).toLocaleString('id-ID') %>
                        </a>
                    </div>
                </text>);

                sub.Add().DataField("JumlahOP2024").Caption("2024").Alignment(HorizontalAlignment.Center)
                .CellTemplate(@<text>
                    <div style="display: flex; align-items: center; justify-content: flex-end;">
                        <a href="javascript:void(0);"
                            class="value-link text-decoration-none"
                            onclick="onDetailPemeriksaanClick('<%- data.JenisPajak %>', 2024)"
                            title="Lihat Detail Pemeriksaan 2024">
                            <%- (value || 0).toLocaleString('id-ID') %>
                        </a>
                    </div>
                </text>);

                sub.Add().DataField("JumlahOP2025").Caption("2025").Alignment(HorizontalAlignment.Center)
                .CellTemplate(@<text>
                    <div style="display: flex; align-items: center; justify-content: flex-end;">
                        <a href="javascript:void(0);"
                            class="value-link text-decoration-none"
                            onclick="onDetailPemeriksaanClick('<%- data.JenisPajak %>', 2025)"
                            title="Lihat Detail Pemeriksaan 2025">
                            <%- (value || 0).toLocaleString('id-ID') %>
                        </a>
                    </div>
                </text>);
            });

            columns.Add()
            .Caption("JUMLAH KURANG BAYAR")
            .Alignment(HorizontalAlignment.Center)
            .Columns(sub =>
            {
                sub.Add().Caption("2023").Alignment(HorizontalAlignment.Center).Columns(kb2023 =>
            {
                kb2023.Add().DataField("Pokok2023").Caption("POKOK").Alignment(HorizontalAlignment.Center).Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR")).Alignment(HorizontalAlignment.Right);
                kb2023.Add().DataField("Sanksi2023").Caption("SANKSI").Alignment(HorizontalAlignment.Center).Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR")).Alignment(HorizontalAlignment.Right);
                kb2023.Add().DataField("Total2023").Caption("TOTAL").Alignment(HorizontalAlignment.Center).Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR")).Alignment(HorizontalAlignment.Right);
            });
                sub.Add().Caption("2024").Alignment(HorizontalAlignment.Center).Columns(kb2024 =>
            {
                kb2024.Add().DataField("Pokok2024").Caption("POKOK").Alignment(HorizontalAlignment.Center).Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR")).Alignment(HorizontalAlignment.Right);
                kb2024.Add().DataField("Sanksi2024").Caption("SANKSI").Alignment(HorizontalAlignment.Center).Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR")).Alignment(HorizontalAlignment.Right);
                kb2024.Add().DataField("Total2024").Caption("TOTAL").Alignment(HorizontalAlignment.Center).Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR")).Alignment(HorizontalAlignment.Right);
            });
                sub.Add().Caption("2025").Alignment(HorizontalAlignment.Center).Columns(kb2025 =>
            {
                kb2025.Add().DataField("Pokok2025").Caption("POKOK").Alignment(HorizontalAlignment.Center).Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR")).Alignment(HorizontalAlignment.Right);
                kb2025.Add().DataField("Sanksi2025").Caption("SANKSI").Alignment(HorizontalAlignment.Center).Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR")).Alignment(HorizontalAlignment.Right);
                kb2025.Add().DataField("Total2025").Caption("TOTAL").Alignment(HorizontalAlignment.Center).Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR")).Alignment(HorizontalAlignment.Right);
            });
            });
        })
        )
</div>
