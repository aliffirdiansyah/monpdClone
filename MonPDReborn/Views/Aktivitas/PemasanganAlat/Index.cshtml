@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

<div class="row">
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header d-flex">
                <div class="flex-grow-1">
                    <h4 class="card-title fs-16 mb-0">
                        Pemasangan Alat
                    </h4>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header d-flex">
                <div class="flex-grow-1">
                    <h4 class="card-title fs-16 mb-0">
                        Jumlah Terpasang dan Belum Terpasang Tahun
                    </h4>
                </div>
            </div>
            <div class="card-body">
                @{
                    var startYear = 2021;
                    var endYear = 2025;
                }
                @{
                    Html.DevExtreme().DataGrid()
                            .ID("gridJumlahPemasangan")
                            .ShowBorders(true)
                            .ShowColumnLines(true)
                            .ShowRowLines(true)
                            .ColumnAutoWidth(true)
                            .DataSource(new object[0])
                            .Columns(columns =>
                            {
                                columns.Add().Caption("No").Width(50);
                                columns.Add().Caption("Jenis Pajak");

                                // Tahun 2022–2025
                                for (int year = 2021; year <= 2025; year++)
                                {
                                    columns.Add()
                                    .Caption(year.ToString())
                                    .Columns(sub =>
                                    {
                                        sub.Add().Caption("Terpasang");
                                        sub.Add().Caption("Belum Terpasang");
                                    });
                                }
                            })
                            .Render();
                }
            </div>
        </div>
    </div>
    <div class="col-lg-12">
        <div class="card">
            <div class="card-header d-flex">
                <div class="flex-grow-1">
                    <h4 class="card-title fs-16 mb-0">
                        Detail Pemasangan Alat Pada Objek Pajak
                    </h4>
                </div>
            </div>
            <div class="card-body">
                @{
                    Html.DevExtreme().DataGrid()
                        .ID("DetailGrid")
                        .DataSource(new JS("masterData"))
                        .KeyExpr("JenisPajak")
                        .ShowBorders(true)
                        .ShowRowLines(true)
                        .ColumnAutoWidth(true)
                        .Columns(columns =>
                        {
                            columns.Add().DataField("JenisPajak").Caption("Jenis Pajak");
                            columns.Add().DataField("JumlahOP");
                            columns.Add().DataField("TerpasangTS");
                            columns.Add().DataField("TerpasangTB");
                            columns.Add().DataField("TerpasangSB");
                            columns.Add().DataField("TotalTerpasang");
                            columns.Add().DataField("BelumTerpasang");
                        })
                        .MasterDetail(md => md
                        .Enabled(true)
                        .Template(new JS("detailTemplate"))
                        )
                        .Render();
                }
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        const masterData = [
            {
                JenisPajak: "HOTEL",
                
            },
            {
                JenisPajak: "RESTORAN",
                
            },
            {
                JenisPajak: "HIBURAN NON BIOSKOP",
                
            },
            {
                JenisPajak: "HIBURAN BIOSKOP",
                
            },
            {
                JenisPajak: "PARKIR",
                
            }
        ];

        function detailTemplate(detail) {
            const kategori = detail.data.Kategori;
            return $("<div>").dxDataGrid({
                dataSource: kategori,
                showBorders: true,
                rowAlternationEnabled: true,
                columnAutoWidth: true,
                columns: [
                    { dataField: "Kategori", caption: "Kategori", cellTemplate: function (container, options) {
                        $("<strong>").text(options.value).appendTo(container);
                    }},
                    { dataField: "JumlahOP" },
                    { dataField: "TerpasangTS" },
                    { dataField: "TerpasangTB" },
                    { dataField: "TerpasangSB" },
                    { dataField: "TotalTerpasang" },
                    { dataField: "BelumTerpasang" }
                ]
            });
        }
    </script>
}

