@model MonPDReborn.Models.DataOP.ProfilePotensiOPVM.Show

@(
Html.DevExtreme().DataGrid<MonPDReborn.Models.DataOP.ProfilePotensiOPVM.DataPotensi>()
    .ID("dataPotensiGrid")
    .DataSource(Model.DataPotensiList)
    .ShowBorders(true)
    .ShowColumnHeaders(true)
    .ShowColumnLines(true)
    .ShowRowLines(true)
    .AllowColumnResizing(true)
    .RowAlternationEnabled(true)
    .ColumnAutoWidth(true)
        .SearchPanel(s => s.Visible(true).HighlightCaseSensitive(false))
        .FilterRow(f => f.Visible(true))
        .HeaderFilter(h => h.Visible(true))
        .Sorting(s => s.Mode(GridSortingMode.Multiple))
    .Paging(p => p.PageSize(10))
    .Pager(p => p
        .ShowPageSizeSelector(true)
        .AllowedPageSizes(new[] { 10, 20, 50 })
        .ShowInfo(true)
    )
    .SearchPanel(sp => sp
        .Visible(true)
        .Width(240)
        .Placeholder("Cari...")
    )
    .Columns(columns =>
    {
        columns.AddFor(m => m.NOP).Caption("NOP");
        columns.AddFor(m => m.NamaWP).Caption("Nama WP");
        columns.AddFor(m => m.Alamat).Caption("Alamat");
        columns.AddFor(m => m.JenisPajak).Caption("Jenis Pajak");
        columns.AddFor(m => m.MasaPajak).Caption("Masa Pajak");
        columns.AddFor(m => m.Potensi).Caption("Potensi").Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR"));
        columns.AddFor(m => m.Realisasi).Caption("Realisasi").Format(f => f.Type(Format.Currency).Precision(0).Currency("IDR"));
        columns.AddFor(m => m.Tahun).Caption("Tahun");
        columns.Add()
               .Type(GridCommandColumnType.Buttons)
               .Buttons(b =>
               {
                   b.Add()
                   .Text("Detail")
                   .Icon("search")
                   .OnClick("onDetailClick");
               });
    })
    .Summary(summary => {
        summary.TotalItems(items =>
        {
            items.AddFor(m => m.MasaPajak)
                 .SummaryType(SummaryType.Sum)
                 .DisplayFormat("Total");

            items.AddFor(m => m.Potensi)
            .SummaryType(SummaryType.Sum)
            .CustomizeText(@<text>
                function(data) {
                    const formatted = new Intl.NumberFormat('id-ID', {
                        style: 'currency',
                        currency: 'IDR',
                        minimumFractionDigits: 0
                    }).format(data.value);
                    return formatted;
                }
            </text>);

            items.AddFor(m => m.Realisasi)
            .SummaryType(SummaryType.Sum)
            .CustomizeText(@<text>
                function(data) {
                    const formatted = new Intl.NumberFormat('id-ID', {
                        style: 'currency',
                        currency: 'IDR',
                        minimumFractionDigits: 0
                    }).format(data.value);
                    return formatted;
                }
            </text>);
        });
    })
)