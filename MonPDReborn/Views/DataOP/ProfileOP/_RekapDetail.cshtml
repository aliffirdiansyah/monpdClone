@(Html.DevExtreme().DataGrid<MonPDReborn.Models.DataOP.ProfileOPVM.RekapDetail>()
    .DataSource(d => d.Mvc()
    .LoadAction("GetRekapDetailData")
    .Key("Kategori")
    .LoadParams(new
    {
        JenisPajak = ViewData["JenisPajakRekap"],
        Tahun = ViewData["tahun"]
    })
    )
    .ShowColumnLines(true)
    .ShowRowLines(true)
    .ShowBorders(true)
    .ShowColumnHeaders(true)
    .RowAlternationEnabled(true)
    .ColumnAutoWidth(true)
    .Paging(p => p.PageSize(10))
    .Pager(p => p
        .ShowPageSizeSelector(true)
        .AllowedPageSizes(new[] { 5, 10, 20 })
        .ShowInfo(true)
    )
    .Columns(columns =>
    {

        columns.AddFor(m => m.Kategori).Caption("Kategori").CssClass("fw-bold");
        columns.AddFor(m => m.JmlOpAwal)
            .DataField("OPAwal")
            .Caption("OP Awal")
            .CellTemplate(@<text>
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <button class="btn btn-sm btn-outline-primary me-2"
                            onclick="onDetailClick('<%- data.EnumPajak %>','<%- data.KategoriId %>', 'JmlOpAwal', '<%- data.Tahun %>')"
                            title="Lihat Detail">
                        <i class="ri-search-line"></i>
                    </button>
                    <span><%- value %></span>
                </div>
            </text>)
            .CalculateCellValue("data => data.JmlOpAwal");

        columns.AddFor(m => m.JmlOpTutupPermanen)
            .DataField("JmlOpTutupPermanen")
            .Caption("OP Tutup")
            .CellTemplate(@<text>
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <button class="btn btn-sm btn-outline-secondary me-2"
                            onclick="onDetailClick('<%- data.EnumPajak %>','<%- data.KategoriId %>', 'JmlOpTutupPermanen', '<%- data.Tahun %>')"
                            title="Lihat Detail">
                        <i class="ri-search-line"></i>
                    </button>
                    <span><%- data.JmlOpTutupPermanen %></span>
                </div>
            </text>)
            .CalculateCellValue("data => data.JmlOpTutupPermanen");

        columns.AddFor(m => m.JmlOpBaru)
            .DataField("JmlOpBaru")
            .Caption("OP Baru")
            .CellTemplate(@<text>
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <button class="btn btn-sm btn-outline-success me-2"
                            onclick="onDetailClick('<%- data.EnumPajak %>','<%- data.KategoriId %>', 'JmlOpBaru', '<%- data.Tahun %>')"
                            title="Lihat Detail">
                        <i class="ri-search-line"></i>
                    </button>
                    <span><%- data.JmlOpBaru %></span>
                </div>
            </text>)
            .CalculateCellValue("data => data.JmlOpBaru");


        columns.AddFor(m => m.JmlOpAkhir)
            .DataField("JmlOpAkhir")
            .Caption("OP Akhir")
            .CellTemplate(@<text>
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <button class="btn btn-sm btn-outline-info me-2"
                            onclick="onDetailClick('<%- data.EnumPajak %>','<%- data.KategoriId %>', 'JmlOpAkhir', '<%- data.Tahun %>')"
                            title="Lihat Detail">
                        <i class="ri-search-line"></i>
                    </button>
                    <span><%- data.JmlOpAkhir %></span>
                </div>
            </text>)
            .CalculateCellValue("data => data.JmlOpAkhir");


    })
    .Summary(s =>
    {
        s.TotalItems(items =>
        {
            items.Add()
                .Column("Kategori")
                .SummaryType(SummaryType.Sum)
                .DisplayFormat("Total")
                .Alignment(HorizontalAlignment.Center);

            items.Add()
                .Column("OPAwal")
                .SummaryType(SummaryType.Sum)
                .DisplayFormat("{0}")
                .Alignment(HorizontalAlignment.Right);

            items.Add()
                .Column("TutupSementara")
                .SummaryType(SummaryType.Sum)
                .DisplayFormat("{0}")
                .Alignment(HorizontalAlignment.Right);

            items.Add()
                .Column("TutupPermanen")
                .SummaryType(SummaryType.Sum)
                .DisplayFormat("{0}")
                .Alignment(HorizontalAlignment.Right);

            items.Add()
                .Column("OPBaru")
                .SummaryType(SummaryType.Sum)
                .DisplayFormat("{0}")
                .Alignment(HorizontalAlignment.Right);

            items.Add()
                .Column("Buka")
                .SummaryType(SummaryType.Sum)
                .DisplayFormat("{0}")
                .Alignment(HorizontalAlignment.Right);

        });
    })
)